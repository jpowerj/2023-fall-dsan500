<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jeff Jacobs">

<title>DSAN 5000 - Week 11: Decision Trees</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ETYTX4E16L"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-ETYTX4E16L', { 'anonymize_ip': true});
</script>
<script src="https://code.jquery.com/jquery-3.7.1.slim.min.js"></script><script src="../jjcustom.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">
      DSAN 5000
      </li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">DSAN 5000</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://jfh.georgetown.domains/dsan5000/" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><i class="bi bi-arrow-left" style="margin-right: 4px"></i>Main Course Page</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><i class="bi bi-house pe-1"></i> Section <span class="sec-num">02</span> Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w01/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 1: <span class="sec-w01-date">Aug 23</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w02/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 2: <span class="sec-w02-date">Aug 29</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w03/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 3: <span class="sec-w03-date">Sep 6</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w04/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 4: <span class="sec-w04-date">Sep 12</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w05/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 5: <span class="sec-w05-date">Sep 19</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w06/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 6: <span class="sec-w06-date">Sep 26</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w07/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 7: <span class="sec-w07-date">Oct 3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w08/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 8: <span class="sec-w08-date">Oct 17</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w09/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 9: <span class="sec-w09-date">Oct 24</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../w10/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 10: <span class="sec-w10-date">Oct 31</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../recordings/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture Recordings</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../extra-videos/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra Videos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../writeups/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra Writeups</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cheatsheet-code/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coding Cheatsheet</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../presentations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab Presentations</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://georgetown.instructure.com/courses/173310" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Canvas Page <i class="bi bi-box-arrow-up-right ps-1"></i></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://calendar.app.google/yMnESMtMNPdKEaPz5" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Book Office Hours <i class="bi bi-box-arrow-up-right ps-1"></i></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://forms.gle/TH1yLitU9dTfB4sg8" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Suggestion Box <i class="bi bi-box-arrow-up-right ps-1"></i></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#schedule" id="toc-schedule" class="nav-link active" data-scroll-target="#schedule">Schedule</a></li>
  <li><a href="#quiz-prep" id="toc-quiz-prep" class="nav-link" data-scroll-target="#quiz-prep">Quiz Prep</a>
  <ul class="collapse">
  <li><a href="#reducing-dimensionality" id="toc-reducing-dimensionality" class="nav-link" data-scroll-target="#reducing-dimensionality">Reducing Dimensionality</a></li>
  <li><a href="#principal-component-analysis-pca" id="toc-principal-component-analysis-pca" class="nav-link" data-scroll-target="#principal-component-analysis-pca">Principal Component Analysis (PCA)</a></li>
  <li><a href="#pca-math-magic" id="toc-pca-math-magic" class="nav-link" data-scroll-target="#pca-math-magic">PCA Math Magic</a></li>
  <li><a href="#now-with-pca-lines-neq-axes" id="toc-now-with-pca-lines-neq-axes" class="nav-link" data-scroll-target="#now-with-pca-lines-neq-axes">Now With PCA Lines <span class="math inline">\(\neq\)</span> Axes</a></li>
  <li><a href="#pca-and-eigenvalues" id="toc-pca-and-eigenvalues" class="nav-link" data-scroll-target="#pca-and-eigenvalues">PCA and Eigenvalues</a></li>
  <li><a href="#pca-as-swiss-army-knife" id="toc-pca-as-swiss-army-knife" class="nav-link" data-scroll-target="#pca-as-swiss-army-knife">PCA as Swiss Army Knife</a></li>
  <li><a href="#t-sne-for-dimensionality-reduction" id="toc-t-sne-for-dimensionality-reduction" class="nav-link" data-scroll-target="#t-sne-for-dimensionality-reduction">t-SNE for Dimensionality Reduction</a></li>
  <li><a href="#what-happens-as-we-vary-perplexity" id="toc-what-happens-as-we-vary-perplexity" class="nav-link" data-scroll-target="#what-happens-as-we-vary-perplexity">What Happens As We Vary Perplexity?</a></li>
  <li><a href="#quiz-time" id="toc-quiz-time" class="nav-link" data-scroll-target="#quiz-time">Quiz Time!</a></li>
  </ul></li>
  <li><a href="#decision-trees" id="toc-decision-trees" class="nav-link" data-scroll-target="#decision-trees">Decision Trees</a>
  <ul class="collapse">
  <li><a href="#questions" id="toc-questions" class="nav-link" data-scroll-target="#questions">20 Questions</a></li>
  <li><a href="#we-can-quantify-how-good-a-sequence-of-questions-is" id="toc-we-can-quantify-how-good-a-sequence-of-questions-is" class="nav-link" data-scroll-target="#we-can-quantify-how-good-a-sequence-of-questions-is">We Can Quantify How Good a Sequence of Questions Is!</a></li>
  <li><a href="#lets-use-math" id="toc-lets-use-math" class="nav-link" data-scroll-target="#lets-use-math">Let’s Use Math</a></li>
  <li><a href="#lets-use-different-math" id="toc-lets-use-different-math" class="nav-link" data-scroll-target="#lets-use-different-math">Let’s Use (Different) Math</a></li>
  <li><a href="#entropy-seems-helpful-here" id="toc-entropy-seems-helpful-here" class="nav-link" data-scroll-target="#entropy-seems-helpful-here">Entropy Seems Helpful Here…</a></li>
  <li><a href="#the-mathematical-relationship" id="toc-the-mathematical-relationship" class="nav-link" data-scroll-target="#the-mathematical-relationship">The Mathematical Relationship</a></li>
  <li><a href="#decision-tree-structure" id="toc-decision-tree-structure" class="nav-link" data-scroll-target="#decision-tree-structure">Decision Tree Structure</a></li>
  <li><a href="#how-are-they-built" id="toc-how-are-they-built" class="nav-link" data-scroll-target="#how-are-they-built">How Are They Built?</a></li>
  <li><a href="#zero-splits" id="toc-zero-splits" class="nav-link" data-scroll-target="#zero-splits">Zero Splits</a></li>
  <li><a href="#judging-split-options" id="toc-judging-split-options" class="nav-link" data-scroll-target="#judging-split-options">Judging Split Options</a></li>
  <li><a href="#scikit-learn" id="toc-scikit-learn" class="nav-link" data-scroll-target="#scikit-learn">Scikit-Learn</a></li>
  <li><a href="#continuous-values" id="toc-continuous-values" class="nav-link" data-scroll-target="#continuous-values">Continuous Values</a></li>
  <li><a href="#looking-towards-regression" id="toc-looking-towards-regression" class="nav-link" data-scroll-target="#looking-towards-regression">Looking Towards Regression</a></li>
  <li><a href="#a-zero-level-tree" id="toc-a-zero-level-tree" class="nav-link" data-scroll-target="#a-zero-level-tree">A Zero-Level Tree</a></li>
  <li><a href="#a-one-level-binary-tree" id="toc-a-one-level-binary-tree" class="nav-link" data-scroll-target="#a-one-level-binary-tree">A One-Level Binary Tree</a></li>
  <li><a href="#a-one-level-ternary-tree" id="toc-a-one-level-ternary-tree" class="nav-link" data-scroll-target="#a-one-level-ternary-tree">A One-Level Ternary Tree</a></li>
  <li><a href="#another-one-level-ternary-tree" id="toc-another-one-level-ternary-tree" class="nav-link" data-scroll-target="#another-one-level-ternary-tree">Another One-Level Ternary Tree</a></li>
  <li><a href="#on-to-the-code" id="toc-on-to-the-code" class="nav-link" data-scroll-target="#on-to-the-code">On to the Code!</a></li>
  </ul></li>
  <li><a href="#random-forests" id="toc-random-forests" class="nav-link" data-scroll-target="#random-forests">Random Forests</a>
  <ul class="collapse">
  <li><a href="#the-wisdom-of-crowds" id="toc-the-wisdom-of-crowds" class="nav-link" data-scroll-target="#the-wisdom-of-crowds">The Wisdom of Crowds</a></li>
  <li><a href="#your-opponents" id="toc-your-opponents" class="nav-link" data-scroll-target="#your-opponents">Your Opponents</a></li>
  <li><a href="#high-variance-low-bias" id="toc-high-variance-low-bias" class="nav-link" data-scroll-target="#high-variance-low-bias">High Variance, Low Bias</a></li>
  <li><a href="#the-wisdom-of-sheep" id="toc-the-wisdom-of-sheep" class="nav-link" data-scroll-target="#the-wisdom-of-sheep">The Wisdom of Sheep</a></li>
  <li><a href="#appendix-covariance-matrix-magic" id="toc-appendix-covariance-matrix-magic" class="nav-link" data-scroll-target="#appendix-covariance-matrix-magic">Appendix: Covariance Matrix Magic</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="slides.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 11: Decision Trees</h1>
<p class="subtitle lead"><em>DSAN 5000: Data Science and Analytics</em><br>Section <span class="sec-num">02</span></p>
  <div class="quarto-categories">
    <div class="quarto-category">Class Sessions</div>
  </div>
  </div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Jeff Jacobs </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="mailto:jj1088@georgetown.edu" target="_blank">jj1088@georgetown.edu</a>
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Tuesday, October 31, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<center>
<a class="h2" href="./slides.html" target="_blank">Open slides in new window →</a>
</center>
<section id="schedule" class="level1 smaller small-title crunch-title crunch-callout" data-name="Schedule">
<h1 class="smaller small-title crunch-title crunch-callout" data-name="Schedule">Schedule</h1>
<div class="hidden">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"../_globals.r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="hidden">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cb_palette <span class="op">=</span> [<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>]</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Markdown</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> disp(df, floatfmt<span class="op">=</span><span class="st">'g'</span>, include_index<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Markdown(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    df.to_markdown(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>      floatfmt<span class="op">=</span>floatfmt,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>      index<span class="op">=</span>include_index</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> summary_to_df(summary_obj, corner_col <span class="op">=</span> <span class="st">''</span>):</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    reg_df <span class="op">=</span> pd.DataFrame(summary_obj.tables[<span class="dv">1</span>].data)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    reg_df.columns <span class="op">=</span> reg_df.iloc[<span class="dv">0</span>]</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    reg_df <span class="op">=</span> reg_df.iloc[<span class="dv">1</span>:].copy()</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save index col</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    index_col <span class="op">=</span> reg_df[<span class="st">''</span>]</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Drop for now, so it's all numeric</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    reg_df.drop(columns<span class="op">=</span>[<span class="st">''</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    reg_df <span class="op">=</span> reg_df.<span class="bu">apply</span>(pd.to_numeric)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    my_round <span class="op">=</span> <span class="kw">lambda</span> x: <span class="bu">round</span>(x, <span class="dv">2</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    reg_df <span class="op">=</span> reg_df.<span class="bu">apply</span>(my_round)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    numeric_cols <span class="op">=</span> reg_df.columns</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add index col back in</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    reg_df.insert(loc<span class="op">=</span><span class="dv">0</span>, column<span class="op">=</span>corner_col, value<span class="op">=</span>index_col)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sigh. Have to escape | characters?</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    reg_df.columns <span class="op">=</span> [c.replace(<span class="st">"|"</span>,<span class="st">"\|"</span>) <span class="cf">for</span> c <span class="kw">in</span> reg_df.columns]</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reg_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="hidden">
<p><span class="math display">\[
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}
\newcommand{\bigexpect}[1]{\mathbb{E}\mkern-4mu \left[ #1 \right]}
\newcommand{\definedas}{\overset{\text{defn}}{=}}
\newcommand{\definedalign}{\overset{\phantom{\text{defn}}}{=}}
\newcommand{\eqeventual}{\overset{\text{eventually}}{=}}
\newcommand{\expect}[1]{\mathbb{E}[#1]}
\newcommand{\expectsq}[1]{\mathbb{E}^2[#1]}
\newcommand{\fw}[1]{\texttt{#1}}
\newcommand{\given}{\mid}
\newcommand{\green}[1]{\color{green}{#1}}
\newcommand{\heads}{\outcome{heads}}
\newcommand{\iqr}{\text{IQR}}
\newcommand{\kl}{\text{KL}}
\newcommand{\lik}{\mathcal{L}}
\newcommand{\mle}{\textsf{ML}}
\newcommand{\orange}[1]{\color{orange}{#1}}
\newcommand{\outcome}[1]{\textsf{#1}}
\newcommand{\param}[1]{{\color{purple} #1}}
\newcommand{\paramDist}{\param{\boldsymbol\theta_\mathcal{D}}}
\newcommand{\pgsamplespace}{\{\green{1},\green{2},\green{3},\purp{4},\purp{5},\purp{6}\}}
\newcommand{\prob}[1]{P\left( #1 \right)}
\newcommand{\purp}[1]{\color{purple}{#1}}
\newcommand{\red}[1]{\color{red}#1}
\newcommand{\spacecap}{\; \cap \;}
\newcommand{\spacewedge}{\; \wedge \;}
\newcommand{\tails}{\outcome{tails}}
\newcommand{\Var}[1]{\text{Var}[#1]}
\newcommand{\bigVar}[1]{\text{Var}\mkern-4mu \left[ #1 \right]}
\]</span></p>
</div>
<p>Today’s Planned Schedule (Section <span class="sec-num">02</span>):</p>
<table class="table">
<colgroup>
<col style="width: 14%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 50%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Start</th>
<th style="text-align: left;">End</th>
<th style="text-align: left;">Topic</th>
<th style="text-align: center;">Recording</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Lecture</strong></td>
<td style="text-align: left;"><span class="sec-start">12:30pm</span></td>
<td style="text-align: left;"><span class="sec-p30">1:00pm</span></td>
<td style="text-align: left;"><a href="#quiz-prep">Quiz Prep →</a></td>
<td style="text-align: center;"><a id="rec-link-w11-1" href="../recordings/recording-w11s02-1.html" target="_blank"><i class="bi bi-film"></i></a></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="sec-p30">1:00pm</span></td>
<td style="text-align: left;"><span class="sec-p50">1:20pm</span></td>
<td style="text-align: left;"><a href="https://georgetown.instructure.com/courses/173310/quizzes/203758?module_item_id=3453375" target="_blank">Quiz 5.1 <i class="bi bi-box-arrow-up-right"></i></a></td>
<td style="text-align: center;"><a id="rec-link-w11-2" href="../recordings/recording-w11s02-2.html" target="_blank"><i class="bi bi-film"></i></a></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="sec-p50">1:20pm</span></td>
<td style="text-align: left;"><span class="sec-p70">1:40pm</span></td>
<td style="text-align: left;"><a href="#from-w06-data-generating-process-dgp">Decision Trees and Entropy →</a></td>
<td style="text-align: center;"><a id="rec-link-w11-3" href="../recordings/recording-w11s02-3.html" target="_blank"><i class="bi bi-film"></i></a></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="sec-p70">1:40pm</span></td>
<td style="text-align: left;"><span class="sec-p90">2:00pm</span></td>
<td style="text-align: left;"><a href="#from-w06-data-generating-process-dgp">Decision Trees for Classification →</a></td>
<td style="text-align: center;"><a id="rec-link-w10-1" href="../recordings/recording-w10s02-1.html" target="_blank"><i class="bi bi-film"></i></a></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Break!</strong></td>
<td style="text-align: left;"><span class="sec-p90">2:00pm</span></td>
<td style="text-align: left;"><span class="sec-p100">2:10pm</span></td>
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="sec-p100">2:10pm</span></td>
<td style="text-align: left;"><span class="sec-p130">2:40pm</span></td>
<td style="text-align: left;"><a href="#clustering-and-dimensionality-reduction-for-text-data">Decision Trees for Regression →</a></td>
<td style="text-align: center;"><a href="../recordings/recording-w10s02-3.html" target="_blank"><i class="bi bi-film"></i></a></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="sec-p130">2:40pm</span></td>
<td style="text-align: left;"><span class="sec-end">3:00pm</span></td>
<td style="text-align: left;">Student Presentation</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</section>
<section id="quiz-prep" class="level1 page-columns page-full" data-stack-name="Quiz Prep">
<h1 data-stack-name="Quiz Prep">Quiz Prep</h1>
<section id="reducing-dimensionality" class="level2 smaller crunch-title small-math crunch-quarto-layout-cell">
<h2 class="smaller crunch-title small-math crunch-quarto-layout-cell anchored" data-anchor-id="reducing-dimensionality">Reducing Dimensionality</h2>
<style>
.xout {
  background: 
    linear-gradient(to top left,
      rgba(0,0,0,0) 10%,
      rgba(0,0,0,0) calc(50% - 0.8px),
      rgba(255,0,0,1) 50%,
      rgba(0,0,0,0) calc(50% + 0.8px),
      rgba(0,0,0,0) 100%),
    linear-gradient(to top right,
      rgba(0,0,0,0) 10%,
      rgba(0,0,0,0) calc(50% - 0.8px),
      rgba(255,0,0,1) 50%,
      rgba(0,0,0,0) calc(50% + 0.8px),
      rgba(0,0,0,0) 100%);
}
</style>
<ul>
<li>Method 1: Feature <strong>Selection</strong>. Selecting a <strong>subset</strong> of <strong>existing</strong> features:</li>
</ul>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 28.6%;justify-content: center;">
<table id="fs1" class="fwt ctable table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"><span class="math inline">\(F_1\)</span></th>
<th style="text-align: left;" data-quarto-table-cell-role="th"><span class="math inline">\(F_2\)</span></th>
<th style="text-align: left;" data-quarto-table-cell-role="th"><span class="math inline">\(F_3\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.8</td>
<td style="text-align: left;">0.9</td>
<td style="text-align: left;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.6</td>
<td style="text-align: left;">0.4</td>
<td style="text-align: left;">0.1</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 7.1%;justify-content: center;">
<p><span style="display: block; text-align: center;">→</span></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 28.6%;justify-content: center;">
<table id="fs2" class="fwt ctable table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"><span class="math inline">\(F_1\)</span></th>
<th class="xout" style="text-align: center;" data-quarto-table-cell-role="th"><span class="math inline">\(F_2\)</span></th>
<th style="text-align: left;" data-quarto-table-cell-role="th"><span class="math inline">\(F_3\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.8</td>
<td class="xout" style="text-align: left;">0.9</td>
<td style="text-align: left;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.6</td>
<td class="xout" style="text-align: left;">0.4</td>
<td style="text-align: left;">0.1</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 7.1%;justify-content: center;">
<p><span style="display: block; text-align: center;">→</span></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 28.6%;justify-content: center;">
<table id="fs3" data-quarto-postprocess="true" class="table">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"><span class="math inline">\(F_1\)</span></th>
<th style="text-align: left;" data-quarto-table-cell-role="th"><span class="math inline">\(F_3\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.8</td>
<td style="text-align: left;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.6</td>
<td style="text-align: left;">0.1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<ul>
<li>Method 2: Feature <strong>Extraction</strong>. Constructing <strong>new features</strong> as combinations/functions of the original features</li>
</ul>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 28.6%;justify-content: center;">
<table id="fe1" class="fwt ctable table" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"><span class="cb1"><span class="math inline">\(F_1\)</span></span></th>
<th style="text-align: left;" data-quarto-table-cell-role="th"><span class="cb1"><span class="math inline">\(F_2\)</span></span></th>
<th style="text-align: left;" data-quarto-table-cell-role="th"><span class="cb1"><span class="math inline">\(F_3\)</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.8</td>
<td style="text-align: left;">0.9</td>
<td style="text-align: left;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.6</td>
<td style="text-align: left;">0.4</td>
<td style="text-align: left;">0.1</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 7.1%;justify-content: center;">
<p><span style="display: block; text-align: center;">→</span></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 28.6%;justify-content: center;">
<p><span class="math display">\[
\begin{align*}
{\color{#56b4e9}F'_{12}} &amp;= \frac{{\color{#e69f00}F_1} + {\color{#e69f00}F_2}}{2} \\
{\color{#56b4e9}F'_{23}} &amp;= \frac{{\color{#e69f00}F_2} + {\color{#e69f00}F_3}}{2}
\end{align*}
\]</span></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 7.1%;justify-content: center;">
<p><span style="display: block; text-align: center;">→</span></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 28.6%;justify-content: center;">
<table id="fe3" data-quarto-postprocess="true" class="table">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"><span class="cb2"><span class="math inline">\(F'_{12}\)</span></span></th>
<th style="text-align: left;" data-quarto-table-cell-role="th"><span class="cb2"><span class="math inline">\(F'_{23}\)</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.85</td>
<td style="text-align: left;">0.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.50</td>
<td style="text-align: left;">0.25</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="principal-component-analysis-pca" class="level2 smaller crunch-title crunch-code crunch-figures crunch-quarto-layout-panel crunch-ul">
<h2 class="smaller crunch-title crunch-code crunch-figures crunch-quarto-layout-panel crunch-ul anchored" data-anchor-id="principal-component-analysis-pca">Principal Component Analysis (PCA)</h2>
<ul>
<li>We know this is feature <strong>extraction</strong> since we obtain <strong>new dimensions</strong>:</li>
</ul>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>gdp_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"assets/gdp_pca.csv"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>dist_to_line <span class="ot">&lt;-</span> <span class="cf">function</span>(x0, y0, a, c) {</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    numer <span class="ot">&lt;-</span> <span class="fu">abs</span>(a <span class="sc">*</span> x0 <span class="sc">-</span> y0 <span class="sc">+</span> c)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    denom <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a <span class="sc">*</span> a <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(numer <span class="sc">/</span> denom)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding PCA line for industrial vs. exports</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> gdp_df<span class="sc">$</span>industrial</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> gdp_df<span class="sc">$</span>exports</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>lossFn <span class="ot">&lt;-</span> <span class="cf">function</span>(lineParams, x0, y0) {</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> lineParams[<span class="dv">1</span>]</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    c <span class="ot">&lt;-</span> lineParams[<span class="dv">2</span>]</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(<span class="fu">dist_to_line</span>(x0, y0, a, c)))</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>o <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), lossFn, <span class="at">x0 =</span> x, <span class="at">y0 =</span> y)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gdp_df, <span class="fu">aes</span>(<span class="at">x =</span> industrial, <span class="at">y =</span> exports)) <span class="sc">+</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size=</span>g_pointsize<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> o<span class="sc">$</span>par[<span class="dv">1</span>], <span class="at">intercept =</span> o<span class="sc">$</span>par[<span class="dv">2</span>], <span class="at">color=</span><span class="st">"pca"</span>), <span class="at">linewidth=</span>g_linewidth, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="st">"lm"</span>), <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">linewidth=</span>g_linewidth, <span class="at">key_glyph =</span> <span class="st">"blank"</span>) <span class="sc">+</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="fu">element_blank</span>(), <span class="at">values=</span><span class="fu">c</span>(<span class="st">"pca"</span><span class="ot">=</span>cbPalette[<span class="dv">2</span>],<span class="st">"lm"</span><span class="ot">=</span>cbPalette[<span class="dv">1</span>]), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Regression"</span>,<span class="st">"PCA"</span>)) <span class="sc">+</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dsan_theme</span>(<span class="st">"half"</span>) <span class="sc">+</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">remove_legend_title</span>() <span class="sc">+</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"PCA Line vs. Regression Line"</span>,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Industrial Production (% of GDP)"</span>,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Exports (% of GDP)"</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-revealjs/gdp-plot-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gdp_df, <span class="fu">aes</span>(pc1, .fittedPC2)) <span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> g_pointsize<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">color=</span><span class="st">'PCA Line'</span>), <span class="at">linetype=</span><span class="st">'solid'</span>, <span class="at">size=</span>g_linesize) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_rug</span>(<span class="at">sides =</span> <span class="st">"b"</span>, <span class="at">linewidth=</span>g_linewidth<span class="sc">/</span><span class="fl">1.2</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"npc"</span>), <span class="at">color=</span>cbPalette[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expand_limits</span>(<span class="at">y=</span><span class="sc">-</span><span class="fl">1.6</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="fu">element_blank</span>(), <span class="at">values=</span><span class="fu">c</span>(<span class="st">"PCA Line"</span><span class="ot">=</span>cbPalette[<span class="dv">2</span>])) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dsan_theme</span>(<span class="st">"half"</span>) <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">remove_legend_title</span>() <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Exports vs. Industry in Principal Component Space"</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"First Principal Component (Axis of Greatest Variance)"</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Second PC"</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-revealjs/pca-plot-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> gdp_df <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(country_code, pc1, agriculture, military))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>long_df <span class="ot">&lt;-</span> plot_df <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">!</span><span class="fu">c</span>(country_code, pc1), <span class="at">names_to =</span> <span class="st">"var"</span>, <span class="at">values_to =</span> <span class="st">"val"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>long_df <span class="ot">&lt;-</span> long_df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">var =</span> <span class="fu">case_match</span>(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    var,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"agriculture"</span> <span class="sc">~</span> <span class="st">"Agricultural Production"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"military"</span> <span class="sc">~</span> <span class="st">"Military Spending"</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(long_df, <span class="fu">aes</span>(<span class="at">x =</span> pc1, <span class="at">y =</span> val, <span class="at">facet =</span> var)) <span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(var), <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dsan_theme</span>(<span class="st">"full"</span>) <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Industrial-Export Dimension (First Principal Component)"</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"% of GDP"</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-revealjs/pca-facet-plot-1.png" class="img-fluid figure-img" width="1632"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pca-math-magic" class="level2 smaller crunch-title crunch-ul crunch-code crunch-quarto-layout-panel">
<h2 class="smaller crunch-title crunch-ul crunch-code crunch-quarto-layout-panel anchored" data-anchor-id="pca-math-magic">PCA Math Magic</h2>
<ul>
<li>Remember that our <strong>goal</strong> is to find the <strong>axes</strong> along which the data has <strong>greatest variance</strong> (out of all possible axes)</li>
<li>Let’s create a dataset using a <strong>known</strong> data-generating process: one dimension with 75% of the total variance, and the second with 25%:</li>
</ul>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="cell quarto-layout-cell" style="flex-basis: 66.7%;justify-content: center;">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>Mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>var_x <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>var_y <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(var_x, <span class="dv">0</span>, <span class="dv">0</span>, var_y), <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>data_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">mvrnorm</span>(N, Mu, Sigma, <span class="at">empirical=</span><span class="cn">TRUE</span>))</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># data_df &lt;- data_df |&gt; mutate(</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   within_5 = x &lt; 5,</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   within_sq5 = x &lt; sqrt(5)</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#nrow(data_df |&gt; filter(within_5)) / nrow(data_df)</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#nrow(data_df |&gt; filter(within_sq5)) / nrow(data_df)</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># And plot</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_df, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 68% ellipse</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stat_ellipse(geom="polygon", type="norm", linewidth=g_linewidth, level=0.68, fill=cbPalette[1], alpha=0.5) +</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stat_ellipse(type="norm", linewidth=g_linewidth, level=0.68) +</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ellipse</span>(</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x0=</span><span class="dv">0</span>, <span class="at">y0=</span><span class="dv">0</span>, <span class="at">a=</span>var_x, <span class="at">b=</span>var_y, <span class="at">angle=</span><span class="dv">0</span>),</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> g_linewidth</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_ellipse(</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   aes(x0=0, y0=0, a=sqrt(5), b=1, angle=0),</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   linewidth = g_linewidth,</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   geom="polygon",</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   fill=cbPalette[1], alpha=0.2</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ) +</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # 95% ellipse</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stat_ellipse(geom="polygon", type="norm", linewidth=g_linewidth, level=0.95, fill=cbPalette[1], alpha=0.25) +</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stat_ellipse(type="norm", linewidth=g_linewidth, level=0.95) +</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # 99.7% ellipse</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stat_ellipse(geom='polygon', type="norm", linewidth=g_linewidth, level=0.997, fill=cbPalette[1], alpha=0.125) +</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stat_ellipse(type="norm", linewidth=g_linewidth, level=0.997) +</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Lines at x=0 and y=0</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">linewidth=</span>g_linewidth <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">linewidth =</span> g_linewidth <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> g_pointsize <span class="sc">/</span> <span class="dv">3</span>,</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">#alpha=0.5</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">length=</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>), <span class="at">alpha=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span><span class="sc">-</span>var_x, <span class="at">y=</span><span class="dv">0</span>, <span class="at">xend=</span>var_x, <span class="at">yend=</span><span class="dv">0</span>, <span class="at">color=</span><span class="st">'PC1'</span>),</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">1.5</span> <span class="sc">*</span> g_linewidth,</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"npc"</span>))</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="sc">-</span>var_y, <span class="at">xend=</span><span class="dv">0</span>, <span class="at">yend=</span>var_y, <span class="at">color=</span><span class="st">'PC2'</span>),</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">1.5</span> <span class="sc">*</span> g_linewidth,</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"npc"</span>))</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dsan_theme</span>(<span class="st">"half"</span>) <span class="sc">+</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_legend_title</span>() <span class="sc">+</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">"PC Vectors"</span>,</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">values=</span><span class="fu">c</span>(<span class="st">'PC1'</span><span class="ot">=</span>cbPalette[<span class="dv">1</span>], <span class="st">'PC2'</span><span class="ot">=</span>cbPalette[<span class="dv">2</span>])</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>), <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-revealjs/pca-dgp-no-covar-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div id="pca-math-right" class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><span class="math display">\[
\mathbf{\Sigma} = \begin{bmatrix}
{\color{#e69f00}3} &amp; 0 \\
0 &amp; {\color{#56b4e9}1}
\end{bmatrix}
\]</span></p>
<p>Two solutions to <span class="math inline">\(\mathbf{\Sigma}\mathbf{x} = \lambda \mathbf{x}\)</span>:</p>
<ul>
<li><span class="math inline">\({\color{#e69f00}\lambda_1} = 3, {\color{#e69f00}\mathbf{x}_1} = (1, 0)^\top\)</span></li>
<li><span class="math inline">\({\color{#56b4e9}\lambda_2} = 1, {\color{#56b4e9}\mathbf{x}_2} = (0, 1)^\top\)</span></li>
</ul>
</div>
</div>
</div>
</section>
<section id="now-with-pca-lines-neq-axes" class="level2 smaller crunch-title crunch-ul crunch-code crunch-quarto-layout-panel shift-footnotes-20 page-columns page-full">
<h2 class="smaller crunch-title crunch-ul crunch-code crunch-quarto-layout-panel shift-footnotes-20 anchored" data-anchor-id="now-with-pca-lines-neq-axes">Now With PCA Lines <span class="math inline">\(\neq\)</span> Axes</h2>
<ul>
<li>We now introduce <strong>covariance</strong> between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> coordinates of our data:</li>
</ul>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="cell quarto-layout-cell" style="flex-basis: 66.7%;justify-content: center;">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">250</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>Mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>data_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">mvrnorm</span>(N, Mu, Sigma))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Start+end coordinates for the transformed vectors</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>pc1_rc <span class="ot">&lt;-</span> (<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>pc2_rc <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_df, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ellipse</span>(</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x0=</span><span class="dv">0</span>, <span class="at">y0=</span><span class="dv">0</span>, <span class="at">a=</span>var_x, <span class="at">b=</span>var_y, <span class="at">angle=</span>pi<span class="sc">/</span><span class="dv">4</span>),</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> g_linewidth,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#fill='grey', alpha=0.0075</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">linewidth=</span>g_linewidth <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">linewidth =</span> g_linewidth <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> g_pointsize <span class="sc">/</span> <span class="dv">3</span>,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">#alpha=0.7</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">length=</span><span class="fu">unit</span>(<span class="fl">0.35</span>, <span class="st">"cm"</span>), <span class="at">alpha=</span><span class="fl">0.75</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span><span class="sc">-</span>pc1_rc, <span class="at">y=</span><span class="sc">-</span>pc1_rc, <span class="at">xend=</span>pc1_rc, <span class="at">yend=</span>pc1_rc, <span class="at">color=</span><span class="st">'PC1'</span>),</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">1.5</span> <span class="sc">*</span> g_linewidth,</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"npc"</span>))</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>pc2_rc, <span class="at">y=</span><span class="sc">-</span>pc2_rc, <span class="at">xend=</span><span class="sc">-</span>pc2_rc, <span class="at">yend=</span>pc2_rc, <span class="at">color=</span><span class="st">'PC2'</span>),</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">1.5</span> <span class="sc">*</span> g_linewidth,</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"npc"</span>))</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dsan_theme</span>(<span class="st">"half"</span>) <span class="sc">+</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_legend_title</span>() <span class="sc">+</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-revealjs/pca-dgp-covar-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div id="pca-math-covar-right" class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><span class="math display">\[
\mathbf{\Sigma}' = \begin{bmatrix}
2 &amp; 1 \\
1 &amp; 2
\end{bmatrix}
\]</span></p>
<p>Still two solutions to <span class="math inline">\(\mathbf{\Sigma}'\mathbf{x} = \lambda \mathbf{x}\)</span>:</p>
<ul>
<li><span class="math inline">\({\color{#e69f00}\lambda_1} = 3, {\color{#e69f00}\mathbf{x}_1} = (1,1)^\top\)</span></li>
<li><span class="math inline">\({\color{#56b4e9}\lambda_2} = 1, {\color{#56b4e9}\mathbf{x}_2} = (-1,1)^\top\)</span></li>
</ul>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>For those interested in how we obtained <span class="math inline">\(\mathbf{\Sigma}'\)</span> with same eigen<strong>values</strong> but different eigen<strong>vectors</strong> from <span class="math inline">\(\mathbf{\Sigma}\)</span>, see the <a href="#appendix-covariance-matrix-magic">appendix slide</a>.</p>
</div></div></section>
<section id="pca-and-eigenvalues" class="level2">
<h2 class="anchored" data-anchor-id="pca-and-eigenvalues">PCA and Eigenvalues</h2>
<p><em>Takeaway 1</em>: <strong>Regardless of the coordinate system</strong>,</p>
<ul>
<li>Eigen<strong>vectors</strong> give us <strong>axes of greatest variance</strong>: <span class="math inline">\(\mathbf{x}_1\)</span> is axis of greatest variance, <span class="math inline">\(\mathbf{x}_2\)</span> is axis of 2nd-greatest variance, etc.</li>
<li>The corresponding Eigen<strong>values</strong> tell us <strong>how much of the total variance is explained by</strong> this axis</li>
</ul>
</section>
<section id="pca-as-swiss-army-knife" class="level2 smaller crunch-title crunch-quarto-layout-panel crunch-math crunch-ul">
<h2 class="smaller crunch-title crunch-quarto-layout-panel crunch-math crunch-ul anchored" data-anchor-id="pca-as-swiss-army-knife">PCA as Swiss Army Knife</h2>
<ul>
<li>PCA can be used for both <strong>reinterpretation</strong> and <strong>reduction</strong> of dimensions!</li>
<li>Consider dataset <span class="math inline">\(\mathbf{X} = (X_1, \ldots, X_n)\)</span>, with <span class="math inline">\(X_i \in \mathbb{R}^N\)</span></li>
</ul>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="pca-reinterpretation-text" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<center>
<strong>Reinterpretation</strong>
</center>
<p>If we project each <span class="math inline">\(X_i\)</span> onto <span class="math inline">\(N\)</span> principal component axes:</p>
<ul>
<li><p>Datapoints in PC space are <strong>linear combinations</strong> of the original datapoints! (← <em>Takeaway 2a</em>)</p>
<p><span class="math display">\[
  X'_i = \alpha_1X_1 + \cdots + \alpha_nX_n,
  \]</span></p>
<p>where <span class="math inline">\(\forall i \left[\alpha_i \neq 0\right]\)</span></p></li>
<li><p>We are just “re-plotting” our original data in PC space via <strong>change of coordinates</strong></p></li>
<li><p>Thus we can <strong>recover</strong> the original data from the PC data</p></li>
</ul>
</div>
<div id="pca-reduction-text" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<center>
<strong>Reduction</strong>
</center>
<p>If we project <span class="math inline">\(X_i\)</span> onto <span class="math inline">\(M &lt; N\)</span> principal component axes:</p>
<ul>
<li>Datapoints in PC space are <strong>still linear combinations</strong> of the original datapoints (← <em>Takeaway 2b</em>), but now some of the scalars (weights) are 0</li>
<li>We have performed statistically-principled <strong>dimensionality reduction</strong> (← <em>Takeaway 3</em>)</li>
<li>However, original data cannot be recovered</li>
</ul>
</div>
</div>
</div>
</section>
<section id="t-sne-for-dimensionality-reduction" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="t-sne-for-dimensionality-reduction">t-SNE for Dimensionality Reduction</h2>
<ul>
<li><strong>t</strong>-Distributed <strong>S</strong>tochastic <strong>N</strong>eighbor <strong>E</strong>mbedding <span class="citation" data-cites="vandermaaten_visualizing_2008">(<a href="#ref-vandermaaten_visualizing_2008" role="doc-biblioref">Van der Maaten and Hinton 2008</a>)</span></li>
<li>If <span class="math inline">\(x, y\)</span> are <strong>neighbors</strong> in <span class="math inline">\(\mathbb{R}^{1000}\)</span>, t-SNE “succeeds” if they <strong>remain neighbors</strong> in <span class="math inline">\(\mathbb{R}^2\)</span></li>
<li>Key hyperparameter: <strong>perplexity</strong>! Roughly, this affects the “tradeoff” between preserving <strong>local structure</strong> vs.&nbsp;<strong>global structure</strong> in the lower-dimensional space</li>
<li>Choose <span class="math inline">\(x_i \in \mathbb{R}^{1000}\)</span>, and treat it as the center of a <strong>Gaussian ball</strong> with variance <span class="math inline">\(\sigma_i\)</span></li>
<li>The choice of <span class="math inline">\(\sigma_i\)</span> induces a <strong>probability distribution</strong> <span class="math inline">\(P_i\)</span> over <strong>all other points</strong> (what is the probability of drawing <span class="math inline">\(x_j\)</span> from <span class="math inline">\(\mathcal{N}(x_i, \sigma_i)\)</span>?)</li>
</ul>
<p><span class="math display">\[
\text{Perp}(P_i) = 2^{H(P_i)}
\]</span></p>
<ul>
<li><p>High perplexity <span class="math inline">\(\iff\)</span> high entropy (eventually Gaussian ball will grow so big that <strong>all other points will be equally likely!</strong>). So, <strong>vary</strong> perplexity, see how plot changes</p></li>
<li><p>See <a href="https://distill.pub/2016/misread-tsne/" target="_blank">here</a> for an absolutely incredible interactive walkthrough of t-SNE!</p></li>
</ul>
</section>
<section id="what-happens-as-we-vary-perplexity" class="level2 smaller crunch-title crunch-figures crunch-quarto-layout-panel">
<h2 class="smaller crunch-title crunch-figures crunch-quarto-layout-panel anchored" data-anchor-id="what-happens-as-we-vary-perplexity">What Happens As We Vary Perplexity?</h2>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/tsne_00.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Original Dataset</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-panel quarto-layout-cell" style="flex-basis: 75.0%;justify-content: center;">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/tsne_01.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Perplexity = 2</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/tsne_02.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Perplexity = 5</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/tsne_03.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Perplexity = 30</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 11.1%;justify-content: center;">
<p>&nbsp;</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/tsne_04.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Perplexity = 50</figcaption>
</figure>
</div>
</div>
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 11.1%;justify-content: center;">
<p>&nbsp;</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/tsne_05.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Perplexity = 100</figcaption>
</figure>
</div>
</div>
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 11.1%;justify-content: center;">
<p>&nbsp;</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="quiz-time" class="level2">
<h2 class="anchored" data-anchor-id="quiz-time">Quiz Time!</h2>
<ul>
<li><a href="https://georgetown.instructure.com/courses/173310/quizzes/203758?module_item_id=3453375" target="_blank">Quiz 5.1 Link <i class="bi bi-box-arrow-up-right"></i></a></li>
</ul>
</section>
</section>
<section id="decision-trees" class="level1 page-columns page-full" data-stack-name="Decision Trees">
<h1 data-stack-name="Decision Trees">Decision Trees</h1>
<section id="questions" class="level2 smaller crunch-title crunch-ul crunch-code crunch-quarto-layout-panel crunch-images crunch-figures page-columns page-full">
<h2 class="smaller crunch-title crunch-ul crunch-code crunch-quarto-layout-panel crunch-images crunch-figures anchored" data-anchor-id="questions">20 Questions</h2>
<ul>
<li>I am thinking of some <a href="http://wordnetweb.princeton.edu/perl/webwn?s=entity&amp;sub=Search+WordNet&amp;o2=&amp;o0=1&amp;o8=1&amp;o1=1&amp;o7=&amp;o5=&amp;o9=&amp;o6=&amp;o3=&amp;o4=&amp;h=10" target="_blank">entity</a>. What is it?</li>
<li>What questions should we ask initially?</li>
<li>Why might questions on the left be more helpful than questions on the right?</li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th>General Questions</th>
<th>Specific Questions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>Is it a <strong>physical object</strong></em>?</td>
<td><em>Is it a <strong>soda can</strong>?</em></td>
</tr>
<tr class="even">
<td><em>Is it an <strong>animal</strong></em>?</td>
<td>Is it a <strong>cat</strong>?</td>
</tr>
<tr class="odd">
<td><em>Is it <strong>bigger than a house</strong></em>?</td>
<td><em>Is it the planet <strong>Mercury</strong>?</em></td>
</tr>
</tbody>
</table>

<div class="no-row-height column-margin column-container"><div class="">
<p>For linguistics fans: if a word <span class="math inline">\(x\)</span> is one level “more general” than another word <span class="math inline">\(y\)</span> (e.g., the word “camel” is one level more general than “bactrian camel”, a camel with two humps), we say that <span class="math inline">\(x\)</span> is a <strong>hypernym</strong> of <span class="math inline">\(y\)</span>, and that <span class="math inline">\(y\)</span> is a <strong>hyponym</strong> of <span class="math inline">\(x\)</span>. The <a href="https://wordnet.princeton.edu/" target="_blank">WordNet project</a> is a big tree of hypernym/hyponym relationships among all English words, where “entity” is the root node of the tree.</p>
</div></div></section>
<section id="we-can-quantify-how-good-a-sequence-of-questions-is" class="level2 smaller crunch-title title-09 nostretch page-columns page-full">
<h2 class="smaller crunch-title title-09 nostretch anchored" data-anchor-id="we-can-quantify-how-good-a-sequence-of-questions-is">We Can Quantify How Good a Sequence of Questions Is!</h2>
<ul>
<li>Assume we’re playing with someone who only knows three objects <span class="math inline">\(S = \{\text{Tree}, \text{Bird}, \text{Car}\}\)</span>, and they randomize among these such that</li>
</ul>
<table class="table">
<tbody>
<tr class="odd">
<td><span class="math inline">\(\text{Choice}\)</span></td>
<td><strong>Tree</strong></td>
<td><strong>Bird</strong></td>
<td><strong>Car</strong></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\Pr(\text{Choice})\)</span></td>
<td>0.25</td>
<td>0.25</td>
<td>0.50</td>
</tr>
</tbody>
</table>
<ul>
<li>Why might the “script” on the left be a better choice than script in the middle? Why are left and middle both better than right?</li>
</ul>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="cell quarto-layout-cell" data-fig-width="3" data-fig-height="3" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<div id="opt-script">
<div>
<svg width="288" height="288" viewbox="0.00 0.00 219.65 221.60" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 217.6)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-217.6 215.65,-217.6 215.65,4 -4,4"></polygon> <!-- car --> <g id="node1" class="node">
<title>
car
</title>
<ellipse fill="none" stroke="black" cx="58.97" cy="-195.6" rx="29.03" ry="18"></ellipse> <text text-anchor="middle" x="58.97" y="-191.4" font-family="Times,serif" font-size="14.00">Car?</text> </g> <!-- guessCar --> <g id="node2" class="node">
<title>
guessCar
</title>
<polygon fill="none" stroke="black" points="73.9,-124.8 0.03,-124.8 0.03,-88.8 73.9,-88.8 73.9,-124.8"></polygon> <text text-anchor="middle" x="36.97" y="-102.6" font-family="Times,serif" font-size="14.00">Guess Car</text> </g> <!-- car&#45;&gt;guessCar --> <g id="edge1" class="edge">
<title>
car-&gt;guessCar
</title>
<path fill="none" stroke="black" d="M54.62,-177.45C51.55,-165.32 47.36,-148.82 43.84,-134.92"></path> <polygon fill="black" stroke="black" points="47.15,-133.75 41.3,-124.91 40.37,-135.47 47.15,-133.75"></polygon> <text text-anchor="middle" x="60.85" y="-147" font-family="Times,serif" font-size="14.00">Yes</text> </g> <!-- bird --> <g id="node3" class="node">
<title>
bird
</title>
<ellipse fill="none" stroke="black" cx="123.97" cy="-106.8" rx="32.48" ry="18"></ellipse> <text text-anchor="middle" x="123.97" y="-102.6" font-family="Times,serif" font-size="14.00">Bird?</text> </g> <!-- car&#45;&gt;bird --> <g id="edge2" class="edge">
<title>
car-&gt;bird
</title>
<path fill="none" stroke="black" d="M70.89,-178.68C80.69,-165.59 94.74,-146.83 105.92,-131.9"></path> <polygon fill="black" stroke="black" points="108.93,-133.72 112.12,-123.62 103.33,-129.53 108.93,-133.72"></polygon> <text text-anchor="middle" x="106.52" y="-147" font-family="Times,serif" font-size="14.00">No</text> </g> <!-- guessBird --> <g id="node4" class="node">
<title>
guessBird
</title>
<polygon fill="none" stroke="black" points="114.08,-36 35.86,-36 35.86,0 114.08,0 114.08,-36"></polygon> <text text-anchor="middle" x="74.97" y="-13.8" font-family="Times,serif" font-size="14.00">Guess Bird</text> </g> <!-- bird&#45;&gt;guessBird --> <g id="edge3" class="edge">
<title>
bird-&gt;guessBird
</title>
<path fill="none" stroke="black" d="M114.75,-89.47C107.7,-76.99 97.84,-59.52 89.7,-45.1"></path> <polygon fill="black" stroke="black" points="92.61,-43.13 84.65,-36.14 86.51,-46.57 92.61,-43.13"></polygon> <text text-anchor="middle" x="114.85" y="-58.2" font-family="Times,serif" font-size="14.00">Yes</text> </g> <!-- guessTree --> <g id="node5" class="node">
<title>
guessTree
</title>
<polygon fill="none" stroke="black" points="211.83,-36 132.1,-36 132.1,0 211.83,0 211.83,-36"></polygon> <text text-anchor="middle" x="171.97" y="-13.8" font-family="Times,serif" font-size="14.00">Guess Tree</text> </g> <!-- bird&#45;&gt;guessTree --> <g id="edge4" class="edge">
<title>
bird-&gt;guessTree
</title>
<path fill="none" stroke="black" d="M133,-89.47C139.9,-76.99 149.56,-59.52 157.54,-45.1"></path> <polygon fill="black" stroke="black" points="160.71,-46.59 162.49,-36.14 154.58,-43.2 160.71,-46.59"></polygon> <text text-anchor="middle" x="160.52" y="-58.2" font-family="Times,serif" font-size="14.00">No</text> </g> </g>
</svg>
</div>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-fig-width="3" data-fig-height="3" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<div id="subopt-script">
<div>
<svg width="288" height="288" viewbox="0.00 0.00 220.99 221.60" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 217.6)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-217.6 216.99,-217.6 216.99,4 -4,4"></polygon> <!-- bird --> <g id="node1" class="node">
<title>
bird
</title>
<ellipse fill="none" stroke="black" cx="61.31" cy="-195.6" rx="32.48" ry="18"></ellipse> <text text-anchor="middle" x="61.31" y="-191.4" font-family="Times,serif" font-size="14.00">Bird?</text> </g> <!-- guessBird --> <g id="node2" class="node">
<title>
guessBird
</title>
<polygon fill="none" stroke="black" points="78.42,-124.8 0.19,-124.8 0.19,-88.8 78.42,-88.8 78.42,-124.8"></polygon> <text text-anchor="middle" x="39.31" y="-102.6" font-family="Times,serif" font-size="14.00">Guess Bird</text> </g> <!-- bird&#45;&gt;guessBird --> <g id="edge1" class="edge">
<title>
bird-&gt;guessBird
</title>
<path fill="none" stroke="black" d="M56.96,-177.45C53.89,-165.32 49.7,-148.82 46.18,-134.92"></path> <polygon fill="black" stroke="black" points="49.49,-133.75 43.64,-124.91 42.71,-135.47 49.49,-133.75"></polygon> <text text-anchor="middle" x="63.19" y="-147" font-family="Times,serif" font-size="14.00">Yes</text> </g> <!-- car --> <g id="node3" class="node">
<title>
car
</title>
<ellipse fill="none" stroke="black" cx="126.31" cy="-106.8" rx="29.03" ry="18"></ellipse> <text text-anchor="middle" x="126.31" y="-102.6" font-family="Times,serif" font-size="14.00">Car?</text> </g> <!-- bird&#45;&gt;car --> <g id="edge2" class="edge">
<title>
bird-&gt;car
</title>
<path fill="none" stroke="black" d="M73.23,-178.68C83.09,-165.51 97.25,-146.59 108.47,-131.62"></path> <polygon fill="black" stroke="black" points="111.48,-133.43 114.68,-123.33 105.88,-129.23 111.48,-133.43"></polygon> <text text-anchor="middle" x="108.86" y="-147" font-family="Times,serif" font-size="14.00">No</text> </g> <!-- guessCar --> <g id="node4" class="node">
<title>
guessCar
</title>
<polygon fill="none" stroke="black" points="115.24,-36 41.37,-36 41.37,0 115.24,0 115.24,-36"></polygon> <text text-anchor="middle" x="78.31" y="-13.8" font-family="Times,serif" font-size="14.00">Guess Car</text> </g> <!-- car&#45;&gt;guessCar --> <g id="edge4" class="edge">
<title>
car-&gt;guessCar
</title>
<path fill="none" stroke="black" d="M117.28,-89.47C110.37,-76.99 100.71,-59.52 92.74,-45.1"></path> <polygon fill="black" stroke="black" points="95.69,-43.2 87.79,-36.14 89.56,-46.59 95.69,-43.2"></polygon> <text text-anchor="middle" x="118.19" y="-58.2" font-family="Times,serif" font-size="14.00">Yes</text> </g> <!-- guessTree --> <g id="node5" class="node">
<title>
guessTree
</title>
<polygon fill="none" stroke="black" points="213.17,-36 133.44,-36 133.44,0 213.17,0 213.17,-36"></polygon> <text text-anchor="middle" x="173.31" y="-13.8" font-family="Times,serif" font-size="14.00">Guess Tree</text> </g> <!-- car&#45;&gt;guessTree --> <g id="edge3" class="edge">
<title>
car-&gt;guessTree
</title>
<path fill="none" stroke="black" d="M135.15,-89.47C141.91,-76.99 151.37,-59.52 159.17,-45.1"></path> <polygon fill="black" stroke="black" points="162.34,-46.6 164.02,-36.14 156.18,-43.27 162.34,-46.6"></polygon> <text text-anchor="middle" x="161.86" y="-58.2" font-family="Times,serif" font-size="14.00">No</text> </g> </g>
</svg>
</div>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-fig-width="3" data-fig-height="3" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<div id="longer-script">
<div>
<svg width="288" height="288" viewbox="0.00 0.00 245.99 310.40" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 306.4)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-306.4 241.99,-306.4 241.99,4 -4,4"></polygon> <!-- bird --> <g id="node1" class="node">
<title>
bird
</title>
<ellipse fill="none" stroke="black" cx="94.31" cy="-284.4" rx="32.48" ry="18"></ellipse> <text text-anchor="middle" x="94.31" y="-280.2" font-family="Times,serif" font-size="14.00">Bird?</text> </g> <!-- guessBird --> <g id="node2" class="node">
<title>
guessBird
</title>
<polygon fill="none" stroke="black" points="78.42,-213.6 0.19,-213.6 0.19,-177.6 78.42,-177.6 78.42,-213.6"></polygon> <text text-anchor="middle" x="39.31" y="-191.4" font-family="Times,serif" font-size="14.00">Guess Bird</text> </g> <!-- bird&#45;&gt;guessBird --> <g id="edge1" class="edge">
<title>
bird-&gt;guessBird
</title>
<path fill="none" stroke="black" d="M83.96,-267.07C75.97,-254.47 64.77,-236.78 55.58,-222.29"></path> <polygon fill="black" stroke="black" points="58.48,-220.32 50.17,-213.74 52.56,-224.06 58.48,-220.32"></polygon> <text text-anchor="middle" x="83.19" y="-235.8" font-family="Times,serif" font-size="14.00">Yes</text> </g> <!-- bird2 --> <g id="node3" class="node">
<title>
bird2
</title>
<ellipse fill="none" stroke="black" cx="150.31" cy="-195.6" rx="32.48" ry="18"></ellipse> <text text-anchor="middle" x="150.31" y="-191.4" font-family="Times,serif" font-size="14.00">Bird?</text> </g> <!-- bird&#45;&gt;bird2 --> <g id="edge2" class="edge">
<title>
bird-&gt;bird2
</title>
<path fill="none" stroke="black" d="M104.84,-267.07C113.13,-254.22 124.82,-236.1 134.27,-221.45"></path> <polygon fill="black" stroke="black" points="137.34,-223.15 139.82,-212.85 131.46,-219.36 137.34,-223.15"></polygon> <text text-anchor="middle" x="136.86" y="-235.8" font-family="Times,serif" font-size="14.00">No</text> </g> <!-- bird2&#45;&gt;guessBird --> <g id="edge3" class="edge">
<title>
bird2-&gt;guessBird
</title>
<path fill="none" stroke="black" d="M117.76,-195.6C108.62,-195.6 98.47,-195.6 88.59,-195.6"></path> <polygon fill="black" stroke="black" points="88.44,-192.1 78.44,-195.6 88.44,-199.1 88.44,-192.1"></polygon> <text text-anchor="middle" x="98.21" y="-202.8" font-family="Times,serif" font-size="14.00">Yes</text> </g> <!-- car --> <g id="node4" class="node">
<title>
car
</title>
<ellipse fill="none" stroke="black" cx="150.31" cy="-106.8" rx="29.03" ry="18"></ellipse> <text text-anchor="middle" x="150.31" y="-102.6" font-family="Times,serif" font-size="14.00">Car?</text> </g> <!-- bird2&#45;&gt;car --> <g id="edge4" class="edge">
<title>
bird2-&gt;car
</title>
<path fill="none" stroke="black" d="M150.31,-177.45C150.31,-165.32 150.31,-148.82 150.31,-134.92"></path> <polygon fill="black" stroke="black" points="153.81,-134.91 150.31,-124.91 146.81,-134.91 153.81,-134.91"></polygon> <text text-anchor="middle" x="158.86" y="-147" font-family="Times,serif" font-size="14.00">No</text> </g> <!-- guessCar --> <g id="node5" class="node">
<title>
guessCar
</title>
<polygon fill="none" stroke="black" points="140.24,-36 66.37,-36 66.37,0 140.24,0 140.24,-36"></polygon> <text text-anchor="middle" x="103.31" y="-13.8" font-family="Times,serif" font-size="14.00">Guess Car</text> </g> <!-- car&#45;&gt;guessCar --> <g id="edge6" class="edge">
<title>
car-&gt;guessCar
</title>
<path fill="none" stroke="black" d="M141.46,-89.47C134.7,-76.99 125.24,-59.52 117.44,-45.1"></path> <polygon fill="black" stroke="black" points="120.43,-43.27 112.59,-36.14 114.27,-46.6 120.43,-43.27"></polygon> <text text-anchor="middle" x="142.19" y="-58.2" font-family="Times,serif" font-size="14.00">Yes</text> </g> <!-- guessTree --> <g id="node6" class="node">
<title>
guessTree
</title>
<polygon fill="none" stroke="black" points="238.17,-36 158.44,-36 158.44,0 238.17,0 238.17,-36"></polygon> <text text-anchor="middle" x="198.31" y="-13.8" font-family="Times,serif" font-size="14.00">Guess Tree</text> </g> <!-- car&#45;&gt;guessTree --> <g id="edge5" class="edge">
<title>
car-&gt;guessTree
</title>
<path fill="none" stroke="black" d="M159.33,-89.47C166.24,-76.99 175.9,-59.52 183.87,-45.1"></path> <polygon fill="black" stroke="black" points="187.05,-46.59 188.82,-36.14 180.92,-43.2 187.05,-46.59"></polygon> <text text-anchor="middle" x="187.86" y="-58.2" font-family="Times,serif" font-size="14.00">No</text> </g> </g>
</svg>
</div>
</div>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Example adapted from <a href="https://sites.santafe.edu/~simon/it.pdf" target="_blank">this essay</a> by Simon DeDeo!</p>
</div></div></section>
<section id="lets-use-math" class="level2 smaller crunch-title math-70 crunch-quarto-layout-panel crunch-quarto-layout-cell crunch-ul">
<h2 class="smaller crunch-title math-70 crunch-quarto-layout-panel crunch-quarto-layout-cell crunch-ul anchored" data-anchor-id="lets-use-math">Let’s Use Math</h2>
<ul>
<li>An <strong>optimal</strong> script minimizes <strong>average number of questions required</strong> to reach answer</li>
</ul>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-center">
<div id="tree1-math" class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell" data-fig-width="2.5" data-fig-height="2.5">
<div class="cell-output-display">
<div id="opt-script-again">
<div>
<svg width="240" height="240" viewbox="0.00 0.00 219.65 221.60" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 217.6)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-217.6 215.65,-217.6 215.65,4 -4,4"></polygon> <!-- car --> <g id="node1" class="node">
<title>
car
</title>
<ellipse fill="none" stroke="black" cx="58.97" cy="-195.6" rx="29.03" ry="18"></ellipse> <text text-anchor="middle" x="58.97" y="-191.4" font-family="Times,serif" font-size="14.00">Car?</text> </g> <!-- guessCar --> <g id="node2" class="node">
<title>
guessCar
</title>
<polygon fill="none" stroke="black" points="73.9,-124.8 0.03,-124.8 0.03,-88.8 73.9,-88.8 73.9,-124.8"></polygon> <text text-anchor="middle" x="36.97" y="-102.6" font-family="Times,serif" font-size="14.00">Guess Car</text> </g> <!-- car&#45;&gt;guessCar --> <g id="edge1" class="edge">
<title>
car-&gt;guessCar
</title>
<path fill="none" stroke="black" d="M54.62,-177.45C51.55,-165.32 47.36,-148.82 43.84,-134.92"></path> <polygon fill="black" stroke="black" points="47.15,-133.75 41.3,-124.91 40.37,-135.47 47.15,-133.75"></polygon> <text text-anchor="middle" x="60.85" y="-147" font-family="Times,serif" font-size="14.00">Yes</text> </g> <!-- bird --> <g id="node3" class="node">
<title>
bird
</title>
<ellipse fill="none" stroke="black" cx="123.97" cy="-106.8" rx="32.48" ry="18"></ellipse> <text text-anchor="middle" x="123.97" y="-102.6" font-family="Times,serif" font-size="14.00">Bird?</text> </g> <!-- car&#45;&gt;bird --> <g id="edge2" class="edge">
<title>
car-&gt;bird
</title>
<path fill="none" stroke="black" d="M70.89,-178.68C80.69,-165.59 94.74,-146.83 105.92,-131.9"></path> <polygon fill="black" stroke="black" points="108.93,-133.72 112.12,-123.62 103.33,-129.53 108.93,-133.72"></polygon> <text text-anchor="middle" x="106.52" y="-147" font-family="Times,serif" font-size="14.00">No</text> </g> <!-- guessBird --> <g id="node4" class="node">
<title>
guessBird
</title>
<polygon fill="none" stroke="black" points="114.08,-36 35.86,-36 35.86,0 114.08,0 114.08,-36"></polygon> <text text-anchor="middle" x="74.97" y="-13.8" font-family="Times,serif" font-size="14.00">Guess Bird</text> </g> <!-- bird&#45;&gt;guessBird --> <g id="edge3" class="edge">
<title>
bird-&gt;guessBird
</title>
<path fill="none" stroke="black" d="M114.75,-89.47C107.7,-76.99 97.84,-59.52 89.7,-45.1"></path> <polygon fill="black" stroke="black" points="92.61,-43.13 84.65,-36.14 86.51,-46.57 92.61,-43.13"></polygon> <text text-anchor="middle" x="114.85" y="-58.2" font-family="Times,serif" font-size="14.00">Yes</text> </g> <!-- guessTree --> <g id="node5" class="node">
<title>
guessTree
</title>
<polygon fill="none" stroke="black" points="211.83,-36 132.1,-36 132.1,0 211.83,0 211.83,-36"></polygon> <text text-anchor="middle" x="171.97" y="-13.8" font-family="Times,serif" font-size="14.00">Guess Tree</text> </g> <!-- bird&#45;&gt;guessTree --> <g id="edge4" class="edge">
<title>
bird-&gt;guessTree
</title>
<path fill="none" stroke="black" d="M133,-89.47C139.9,-76.99 149.56,-59.52 157.54,-45.1"></path> <polygon fill="black" stroke="black" points="160.71,-46.59 162.49,-36.14 154.58,-43.2 160.71,-46.59"></polygon> <text text-anchor="middle" x="160.52" y="-58.2" font-family="Times,serif" font-size="14.00">No</text> </g> </g>
</svg>
</div>
</div>
</div>
</div>
<p><span class="math display">\[
\begin{align*}
&amp;\mathbb{E}[\text{\# Moves}] \\
=\,&amp;1 \cdot \Pr(\text{Car}) + 2 \cdot \Pr(\text{Bird}) \\
&amp;+ 2 \cdot \Pr(\text{Tree}) \\
=\,&amp;1 \cdot 0.5 + 2\cdot 0.25 + 2\cdot 0.25 \\
=\,&amp;1.5
\end{align*}
\]</span></p>
</div>
<div id="tree2-math" class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell" data-fig-width="2.5" data-fig-height="2.5">
<div class="cell-output-display">
<div id="subopt-script-again">
<div>
<svg width="240" height="240" viewbox="0.00 0.00 220.99 221.60" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 217.6)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-217.6 216.99,-217.6 216.99,4 -4,4"></polygon> <!-- bird --> <g id="node1" class="node">
<title>
bird
</title>
<ellipse fill="none" stroke="black" cx="61.31" cy="-195.6" rx="32.48" ry="18"></ellipse> <text text-anchor="middle" x="61.31" y="-191.4" font-family="Times,serif" font-size="14.00">Bird?</text> </g> <!-- guessBird --> <g id="node2" class="node">
<title>
guessBird
</title>
<polygon fill="none" stroke="black" points="78.42,-124.8 0.19,-124.8 0.19,-88.8 78.42,-88.8 78.42,-124.8"></polygon> <text text-anchor="middle" x="39.31" y="-102.6" font-family="Times,serif" font-size="14.00">Guess Bird</text> </g> <!-- bird&#45;&gt;guessBird --> <g id="edge1" class="edge">
<title>
bird-&gt;guessBird
</title>
<path fill="none" stroke="black" d="M56.96,-177.45C53.89,-165.32 49.7,-148.82 46.18,-134.92"></path> <polygon fill="black" stroke="black" points="49.49,-133.75 43.64,-124.91 42.71,-135.47 49.49,-133.75"></polygon> <text text-anchor="middle" x="63.19" y="-147" font-family="Times,serif" font-size="14.00">Yes</text> </g> <!-- car --> <g id="node3" class="node">
<title>
car
</title>
<ellipse fill="none" stroke="black" cx="126.31" cy="-106.8" rx="29.03" ry="18"></ellipse> <text text-anchor="middle" x="126.31" y="-102.6" font-family="Times,serif" font-size="14.00">Car?</text> </g> <!-- bird&#45;&gt;car --> <g id="edge2" class="edge">
<title>
bird-&gt;car
</title>
<path fill="none" stroke="black" d="M73.23,-178.68C83.09,-165.51 97.25,-146.59 108.47,-131.62"></path> <polygon fill="black" stroke="black" points="111.48,-133.43 114.68,-123.33 105.88,-129.23 111.48,-133.43"></polygon> <text text-anchor="middle" x="108.86" y="-147" font-family="Times,serif" font-size="14.00">No</text> </g> <!-- guessCar --> <g id="node4" class="node">
<title>
guessCar
</title>
<polygon fill="none" stroke="black" points="115.24,-36 41.37,-36 41.37,0 115.24,0 115.24,-36"></polygon> <text text-anchor="middle" x="78.31" y="-13.8" font-family="Times,serif" font-size="14.00">Guess Car</text> </g> <!-- car&#45;&gt;guessCar --> <g id="edge4" class="edge">
<title>
car-&gt;guessCar
</title>
<path fill="none" stroke="black" d="M117.28,-89.47C110.37,-76.99 100.71,-59.52 92.74,-45.1"></path> <polygon fill="black" stroke="black" points="95.69,-43.2 87.79,-36.14 89.56,-46.59 95.69,-43.2"></polygon> <text text-anchor="middle" x="118.19" y="-58.2" font-family="Times,serif" font-size="14.00">Yes</text> </g> <!-- guessTree --> <g id="node5" class="node">
<title>
guessTree
</title>
<polygon fill="none" stroke="black" points="213.17,-36 133.44,-36 133.44,0 213.17,0 213.17,-36"></polygon> <text text-anchor="middle" x="173.31" y="-13.8" font-family="Times,serif" font-size="14.00">Guess Tree</text> </g> <!-- car&#45;&gt;guessTree --> <g id="edge3" class="edge">
<title>
car-&gt;guessTree
</title>
<path fill="none" stroke="black" d="M135.15,-89.47C141.91,-76.99 151.37,-59.52 159.17,-45.1"></path> <polygon fill="black" stroke="black" points="162.34,-46.6 164.02,-36.14 156.18,-43.27 162.34,-46.6"></polygon> <text text-anchor="middle" x="161.86" y="-58.2" font-family="Times,serif" font-size="14.00">No</text> </g> </g>
</svg>
</div>
</div>
</div>
</div>
<p><span class="math display">\[
\begin{align*}
&amp;\mathbb{E}[\text{\# Moves}] \\
=\,&amp;1 \cdot \Pr(\text{Bird}) + 2 \cdot \Pr(\text{Car}) \\
&amp;+ 2 \cdot \Pr(\text{Tree}) \\
=\,&amp;1 \cdot 0.25 + 2\cdot 0.5 + 2\cdot 0.25 \\
=\,&amp;1.75
\end{align*}
\]</span></p>
</div>
<div id="tree3-math" class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell" data-fig-width="2.5" data-fig-height="3">
<div class="cell-output-display">
<div id="longer-script-again">
<div>
<svg width="240" height="288" viewbox="0.00 0.00 245.99 310.40" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 306.4)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-306.4 241.99,-306.4 241.99,4 -4,4"></polygon> <!-- bird --> <g id="node1" class="node">
<title>
bird
</title>
<ellipse fill="none" stroke="black" cx="94.31" cy="-284.4" rx="32.48" ry="18"></ellipse> <text text-anchor="middle" x="94.31" y="-280.2" font-family="Times,serif" font-size="14.00">Bird?</text> </g> <!-- guessBird --> <g id="node2" class="node">
<title>
guessBird
</title>
<polygon fill="none" stroke="black" points="78.42,-213.6 0.19,-213.6 0.19,-177.6 78.42,-177.6 78.42,-213.6"></polygon> <text text-anchor="middle" x="39.31" y="-191.4" font-family="Times,serif" font-size="14.00">Guess Bird</text> </g> <!-- bird&#45;&gt;guessBird --> <g id="edge1" class="edge">
<title>
bird-&gt;guessBird
</title>
<path fill="none" stroke="black" d="M83.96,-267.07C75.97,-254.47 64.77,-236.78 55.58,-222.29"></path> <polygon fill="black" stroke="black" points="58.48,-220.32 50.17,-213.74 52.56,-224.06 58.48,-220.32"></polygon> <text text-anchor="middle" x="83.19" y="-235.8" font-family="Times,serif" font-size="14.00">Yes</text> </g> <!-- bird2 --> <g id="node3" class="node">
<title>
bird2
</title>
<ellipse fill="none" stroke="black" cx="150.31" cy="-195.6" rx="32.48" ry="18"></ellipse> <text text-anchor="middle" x="150.31" y="-191.4" font-family="Times,serif" font-size="14.00">Bird?</text> </g> <!-- bird&#45;&gt;bird2 --> <g id="edge2" class="edge">
<title>
bird-&gt;bird2
</title>
<path fill="none" stroke="black" d="M104.84,-267.07C113.13,-254.22 124.82,-236.1 134.27,-221.45"></path> <polygon fill="black" stroke="black" points="137.34,-223.15 139.82,-212.85 131.46,-219.36 137.34,-223.15"></polygon> <text text-anchor="middle" x="136.86" y="-235.8" font-family="Times,serif" font-size="14.00">No</text> </g> <!-- bird2&#45;&gt;guessBird --> <g id="edge3" class="edge">
<title>
bird2-&gt;guessBird
</title>
<path fill="none" stroke="black" d="M117.76,-195.6C108.62,-195.6 98.47,-195.6 88.59,-195.6"></path> <polygon fill="black" stroke="black" points="88.44,-192.1 78.44,-195.6 88.44,-199.1 88.44,-192.1"></polygon> <text text-anchor="middle" x="98.21" y="-202.8" font-family="Times,serif" font-size="14.00">Yes</text> </g> <!-- car --> <g id="node4" class="node">
<title>
car
</title>
<ellipse fill="none" stroke="black" cx="150.31" cy="-106.8" rx="29.03" ry="18"></ellipse> <text text-anchor="middle" x="150.31" y="-102.6" font-family="Times,serif" font-size="14.00">Car?</text> </g> <!-- bird2&#45;&gt;car --> <g id="edge4" class="edge">
<title>
bird2-&gt;car
</title>
<path fill="none" stroke="black" d="M150.31,-177.45C150.31,-165.32 150.31,-148.82 150.31,-134.92"></path> <polygon fill="black" stroke="black" points="153.81,-134.91 150.31,-124.91 146.81,-134.91 153.81,-134.91"></polygon> <text text-anchor="middle" x="158.86" y="-147" font-family="Times,serif" font-size="14.00">No</text> </g> <!-- guessCar --> <g id="node5" class="node">
<title>
guessCar
</title>
<polygon fill="none" stroke="black" points="140.24,-36 66.37,-36 66.37,0 140.24,0 140.24,-36"></polygon> <text text-anchor="middle" x="103.31" y="-13.8" font-family="Times,serif" font-size="14.00">Guess Car</text> </g> <!-- car&#45;&gt;guessCar --> <g id="edge6" class="edge">
<title>
car-&gt;guessCar
</title>
<path fill="none" stroke="black" d="M141.46,-89.47C134.7,-76.99 125.24,-59.52 117.44,-45.1"></path> <polygon fill="black" stroke="black" points="120.43,-43.27 112.59,-36.14 114.27,-46.6 120.43,-43.27"></polygon> <text text-anchor="middle" x="142.19" y="-58.2" font-family="Times,serif" font-size="14.00">Yes</text> </g> <!-- guessTree --> <g id="node6" class="node">
<title>
guessTree
</title>
<polygon fill="none" stroke="black" points="238.17,-36 158.44,-36 158.44,0 238.17,0 238.17,-36"></polygon> <text text-anchor="middle" x="198.31" y="-13.8" font-family="Times,serif" font-size="14.00">Guess Tree</text> </g> <!-- car&#45;&gt;guessTree --> <g id="edge5" class="edge">
<title>
car-&gt;guessTree
</title>
<path fill="none" stroke="black" d="M159.33,-89.47C166.24,-76.99 175.9,-59.52 183.87,-45.1"></path> <polygon fill="black" stroke="black" points="187.05,-46.59 188.82,-36.14 180.92,-43.2 187.05,-46.59"></polygon> <text text-anchor="middle" x="187.86" y="-58.2" font-family="Times,serif" font-size="14.00">No</text> </g> </g>
</svg>
</div>
</div>
</div>
</div>
<p><span class="math display">\[
\begin{align*}
&amp;\mathbb{E}[\text{\# Moves}] \\
=\,&amp;1 \cdot \Pr(\text{Bird}) + 3 \cdot \Pr(\text{Car}) \\
&amp;+ 3 \cdot \Pr(\text{Tree}) \\
=\,&amp;1 \cdot 0.25 + 3\cdot 0.5 + 3\cdot 0.25 \\
=\,&amp;2.5
\end{align*}
\]</span></p>
</div>
</div>
</div>
</section>
<section id="lets-use-different-math" class="level2 smaller small-math crunch-ul crunch-title">
<h2 class="smaller small-math crunch-ul crunch-title anchored" data-anchor-id="lets-use-different-math">Let’s Use (Different) Math</h2>
<ul>
<li>Forgetting about the individual trees for a moment, let’s compute the <strong>entropy</strong> of the RV representing the opponent’s choice.</li>
<li>In general, if <span class="math inline">\(X\)</span> represents the opponent’s choice and <span class="math inline">\(\mathcal{R}_X = \{1, 2, \ldots, N\}\)</span>, the <strong>entropy</strong> of <span class="math inline">\(X\)</span> is:</li>
</ul>
<p><span class="math display">\[
\begin{align*}
H(X) &amp;= -\sum_{i=1}^N \Pr(X = i)\log_2\Pr(X = i)
\end{align*}
\]</span></p>
<ul>
<li>So in our case we have:</li>
</ul>
<p><span class="math display">\[
\begin{align*}
H(X) &amp;= -\left[ \Pr(X = \text{Car}) \log_2\Pr(X = \text{Car}) \right. \\
&amp;\phantom{= -[ } + \Pr(X = \text{Bird})\log_2\Pr(X = \text{Bird}) \\
&amp;\phantom{= -[ } + \left. \Pr(X = \text{Tree})\log_2\Pr(X = \text{Tree})\right] \\
&amp;= -\left[ (0.5)(-1) + (0.25)(-2) + (0.25)(-2) \right] = 1.5~🧐
\end{align*}
\]</span></p>
</section>
<section id="entropy-seems-helpful-here" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="entropy-seems-helpful-here">Entropy Seems Helpful Here…</h2>
<ul>
<li>Now let’s imagine our opponent randomizes between all three options:</li>
</ul>
<p><span class="math display">\[
\begin{align*}
\mathbb{E}[\text{\# Moves}] &amp;= 1 \cdot (1/3) + 2 \cdot (1/3) + 2 \cdot (1/3) \\
&amp;= \frac{5}{3} \approx 1.667
\end{align*}
\]</span></p>
<p><span class="math display">\[
\begin{align*}
H(X) &amp;= -\left[ \Pr(X = \text{Car}) \log_2\Pr(X = \text{Car}) \right. \\
&amp;\phantom{= -[ } + \Pr(X = \text{Bird})\log_2\Pr(X = \text{Bird}) \\
&amp;\phantom{= -[ } + \left. \Pr(X = \text{Tree})\log_2\Pr(X = \text{Tree})\right] \\
&amp;= -\left[ \frac{1}{3}\log_2\left(\frac{1}{3}\right) + \frac{1}{3}\log_2\left(\frac{1}{3}\right) + \frac{1}{3}\log_2\left(\frac{1}{3}\right) \right] \approx 1.585~🧐
\end{align*}
\]</span></p>
</section>
<section id="the-mathematical-relationship" class="level2">
<h2 class="anchored" data-anchor-id="the-mathematical-relationship">The Mathematical Relationship</h2>
<ol type="1">
<li><p>The <strong>smallest possible number of levels</strong> <span class="math inline">\(L^*\)</span> for a script based on RV <span class="math inline">\(X\)</span> is exactly</p>
<p><span class="math display">\[
L^* = \lceil H(X) \rceil
\]</span></p>
<p><em>Intuition</em>: Although <span class="math inline">\(\mathbb{E}[\text{\# Moves}] = 1.5\)</span>, we cannot have a tree with 1.5 levels!</p></li>
<li><p>Entropy provides a lower bound on <span class="math inline">\(\mathbb{E}[\text{\# Moves}]\)</span>:</p></li>
</ol>
<p><span class="math display">\[
\mathbb{E}[\text{\# Moves}] \geq H(X)
\]</span></p>
</section>
<section id="decision-tree-structure" class="level2 crunch-title crunch-ul">
<h2 class="crunch-title crunch-ul anchored" data-anchor-id="decision-tree-structure">Decision Tree Structure</h2>
<ul>
<li><strong>Leaf Nodes</strong> represent <strong>outcomes</strong></li>
<li><strong>Branch Nodes</strong> represent <strong>questions</strong></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<div>
<svg width="672" height="480" viewbox="0.00 0.00 510.97 221.60" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 217.6)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-217.6 506.97,-217.6 506.97,4 -4,4"></polygon> <!-- root --> <g id="node1" class="node">
<title>
root
</title>
<ellipse fill="none" stroke="black" cx="172.98" cy="-195.6" rx="53.3" ry="18"></ellipse> <text text-anchor="middle" x="172.98" y="-191.4" font-family="Times,serif" font-size="14.00">Root Node</text> </g> <!-- leaf1 --> <g id="node2" class="node">
<title>
leaf1
</title>
<polygon fill="none" stroke="black" points="85.95,-124.8 0.02,-124.8 0.02,-88.8 85.95,-88.8 85.95,-124.8"></polygon> <text text-anchor="middle" x="42.98" y="-102.6" font-family="Times,serif" font-size="14.00">Leaf Node 1</text> </g> <!-- root&#45;&gt;leaf1 --> <g id="edge1" class="edge">
<title>
root-&gt;leaf1
</title>
<path fill="none" stroke="black" d="M150.04,-179.28C129.87,-165.82 100.24,-146.03 77.27,-130.69"></path> <polygon fill="black" stroke="black" points="79.08,-127.69 68.82,-125.05 75.19,-133.51 79.08,-127.69"></polygon> <text text-anchor="middle" x="82.27" y="-156.27" font-family="Times,serif" font-size="14.00">Answer 1</text> </g> <!-- branch1 --> <g id="node3" class="node">
<title>
branch1
</title>
<ellipse fill="none" stroke="black" cx="172.98" cy="-106.8" rx="69.49" ry="18"></ellipse> <text text-anchor="middle" x="172.98" y="-102.6" font-family="Times,serif" font-size="14.00">Branch Node 1</text> </g> <!-- root&#45;&gt;branch1 --> <g id="edge2" class="edge">
<title>
root-&gt;branch1
</title>
<path fill="none" stroke="black" d="M172.98,-177.45C172.98,-165.32 172.98,-148.82 172.98,-134.92"></path> <polygon fill="black" stroke="black" points="176.48,-134.91 172.98,-124.91 169.48,-134.91 176.48,-134.91"></polygon> <text text-anchor="middle" x="200.01" y="-147" font-family="Times,serif" font-size="14.00">Answer 2</text> </g> <!-- branch2 --> <g id="node4" class="node">
<title>
branch2
</title>
<ellipse fill="none" stroke="black" cx="355.98" cy="-106.8" rx="69.49" ry="18"></ellipse> <text text-anchor="middle" x="355.98" y="-102.6" font-family="Times,serif" font-size="14.00">Branch Node 2</text> </g> <!-- root&#45;&gt;branch2 --> <g id="edge3" class="edge">
<title>
root-&gt;branch2
</title>
<path fill="none" stroke="black" d="M202.79,-180.46C233.25,-166.01 280.78,-143.47 314.82,-127.33"></path> <polygon fill="black" stroke="black" points="316.5,-130.4 324.03,-122.95 313.5,-124.08 316.5,-130.4"></polygon> <text text-anchor="middle" x="308.01" y="-147" font-family="Times,serif" font-size="14.00">Answer 3</text> </g> <!-- leaf2 --> <g id="node5" class="node">
<title>
leaf2
</title>
<polygon fill="none" stroke="black" points="86.95,-36 1.02,-36 1.02,0 86.95,0 86.95,-36"></polygon> <text text-anchor="middle" x="43.98" y="-13.8" font-family="Times,serif" font-size="14.00">Leaf Node 2</text> </g> <!-- branch1&#45;&gt;leaf2 --> <g id="edge4" class="edge">
<title>
branch1-&gt;leaf2
</title>
<path fill="none" stroke="black" d="M149.02,-89.68C129.08,-76.26 100.45,-56.99 78.11,-41.96"></path> <polygon fill="black" stroke="black" points="79.83,-38.9 69.58,-36.23 75.93,-44.71 79.83,-38.9"></polygon> <text text-anchor="middle" x="82.18" y="-67.08" font-family="Times,serif" font-size="14.00">Answer 1</text> </g> <!-- leaf3 --> <g id="node6" class="node">
<title>
leaf3
</title>
<polygon fill="none" stroke="black" points="190.95,-36 105.02,-36 105.02,0 190.95,0 190.95,-36"></polygon> <text text-anchor="middle" x="147.98" y="-13.8" font-family="Times,serif" font-size="14.00">Leaf Node 3</text> </g> <!-- branch1&#45;&gt;leaf3 --> <g id="edge5" class="edge">
<title>
branch1-&gt;leaf3
</title>
<path fill="none" stroke="black" d="M168.04,-88.65C164.55,-76.52 159.8,-60.02 155.79,-46.12"></path> <polygon fill="black" stroke="black" points="159.04,-44.75 152.91,-36.11 152.32,-46.69 159.04,-44.75"></polygon> <text text-anchor="middle" x="190.01" y="-58.2" font-family="Times,serif" font-size="14.00">Answer 2</text> </g> <!-- leaf4 --> <g id="node7" class="node">
<title>
leaf4
</title>
<polygon fill="none" stroke="black" points="294.95,-36 209.02,-36 209.02,0 294.95,0 294.95,-36"></polygon> <text text-anchor="middle" x="251.98" y="-13.8" font-family="Times,serif" font-size="14.00">Leaf Node 4</text> </g> <!-- branch1&#45;&gt;leaf4 --> <g id="edge6" class="edge">
<title>
branch1-&gt;leaf4
</title>
<path fill="none" stroke="black" d="M198.96,-89.74C206.59,-84.3 214.58,-77.81 220.98,-70.8 227.94,-63.18 234.13,-53.77 239.11,-45.06"></path> <polygon fill="black" stroke="black" points="242.33,-46.47 244.02,-36.01 236.18,-43.13 242.33,-46.47"></polygon> <text text-anchor="middle" x="261.01" y="-58.2" font-family="Times,serif" font-size="14.00">Answer 3</text> </g> <!-- leaf5 --> <g id="node8" class="node">
<title>
leaf5
</title>
<polygon fill="none" stroke="black" points="398.95,-36 313.02,-36 313.02,0 398.95,0 398.95,-36"></polygon> <text text-anchor="middle" x="355.98" y="-13.8" font-family="Times,serif" font-size="14.00">Leaf Node 5</text> </g> <!-- branch2&#45;&gt;leaf5 --> <g id="edge7" class="edge">
<title>
branch2-&gt;leaf5
</title>
<path fill="none" stroke="black" d="M355.98,-88.65C355.98,-76.52 355.98,-60.02 355.98,-46.12"></path> <polygon fill="black" stroke="black" points="359.48,-46.11 355.98,-36.11 352.48,-46.11 359.48,-46.11"></polygon> <text text-anchor="middle" x="328.96" y="-66.34" font-family="Times,serif" font-size="14.00">Answer 1</text> </g> <!-- leaf6 --> <g id="node9" class="node">
<title>
leaf6
</title>
<polygon fill="none" stroke="black" points="502.95,-36 417.02,-36 417.02,0 502.95,0 502.95,-36"></polygon> <text text-anchor="middle" x="459.98" y="-13.8" font-family="Times,serif" font-size="14.00">Leaf Node 6</text> </g> <!-- branch2&#45;&gt;leaf6 --> <g id="edge8" class="edge">
<title>
branch2-&gt;leaf6
</title>
<path fill="none" stroke="black" d="M375.54,-89.47C391.36,-76.27 413.85,-57.5 431.64,-42.66"></path> <polygon fill="black" stroke="black" points="434.01,-45.24 439.44,-36.14 429.52,-39.86 434.01,-45.24"></polygon> <text text-anchor="middle" x="445.01" y="-58.2" font-family="Times,serif" font-size="14.00">Answer 2</text> </g> </g>
</svg>
</div>
</div>
</div>
</div>
</section>
<section id="how-are-they-built" class="level2 smaller crunch-title crunch-code crunch-figures">
<h2 class="smaller crunch-title crunch-code crunch-figures anchored" data-anchor-id="how-are-they-built">How Are They Built?</h2>
<ul>
<li>Example: we find ourselves at some point on the globe, at some time during the year, and we’re trying to see whether this point+time are <strong>good for skiing</strong></li>
</ul>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>day <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">'2023-01-01'</span>),<span class="fu">ymd</span>(<span class="st">'2023-12-31'</span>),<span class="at">by=</span><span class="st">'weeks'</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>longitude <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">90</span>, <span class="dv">90</span>, <span class="at">by=</span><span class="dv">5</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>ski_df <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(day, longitude)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#ski_df |&gt; head()</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Data-generating process</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>ski_df <span class="ot">&lt;-</span> ski_df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">near_equator =</span> <span class="fu">abs</span>(longitude) <span class="sc">&lt;=</span> <span class="dv">30</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">northern =</span> longitude <span class="sc">&gt;</span> <span class="dv">30</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">southern =</span> longitude <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">30</span>,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">first_3m =</span> day <span class="sc">&lt;</span> <span class="fu">ymd</span>(<span class="st">'2023-04-01'</span>),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">last_3m =</span> day <span class="sc">&gt;=</span> <span class="fu">ymd</span>(<span class="st">'2023-10-01'</span>),</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">middle_6m =</span> (day <span class="sc">&gt;=</span> <span class="fu">ymd</span>(<span class="st">'2023-04-01'</span>)) <span class="sc">&amp;</span> (day <span class="sc">&lt;</span> <span class="fu">ymd</span>(<span class="st">'2023-10-01'</span>)),</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">snowfall =</span> <span class="dv">0</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Update the non-zero sections</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>mu_snow <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>sd_snow <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co"># How many northern + first 3 months</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>num_north_first_3 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(ski_df[ski_df<span class="sc">$</span>northern <span class="sc">&amp;</span> ski_df<span class="sc">$</span>first_3m,])</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>ski_df[ski_df<span class="sc">$</span>northern <span class="sc">&amp;</span> ski_df<span class="sc">$</span>first_3m, <span class="st">'snowfall'</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(num_north_first_3, mu_snow, sd_snow)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Northerns + last 3 months</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>num_north_last_3 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(ski_df[ski_df<span class="sc">$</span>northern <span class="sc">&amp;</span> ski_df<span class="sc">$</span>last_3m,])</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>ski_df[ski_df<span class="sc">$</span>northern <span class="sc">&amp;</span> ski_df<span class="sc">$</span>last_3m, <span class="st">'snowfall'</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(num_north_last_3, mu_snow, sd_snow)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co"># How many southern + middle 6 months</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>num_south_mid_6 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(ski_df[ski_df<span class="sc">$</span>southern <span class="sc">&amp;</span> ski_df<span class="sc">$</span>middle_6m,])</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>ski_df[ski_df<span class="sc">$</span>southern <span class="sc">&amp;</span> ski_df<span class="sc">$</span>middle_6m, <span class="st">'snowfall'</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(num_south_mid_6, mu_snow, sd_snow)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co"># And collapse into binary var</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>ski_df[<span class="st">'good_skiing'</span>] <span class="ot">=</span> ski_df<span class="sc">$</span>snowfall <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co"># This converts day into an int</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>ski_df <span class="ot">&lt;-</span> ski_df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">day_num =</span> lubridate<span class="sc">::</span><span class="fu">yday</span>(day)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="co">#print(nrow(ski_df))</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>ski_sample <span class="ot">&lt;-</span> ski_df <span class="sc">|&gt;</span> <span class="fu">sample_n</span>(<span class="dv">100</span>)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>ski_sample <span class="sc">|&gt;</span> <span class="fu">write_csv</span>(<span class="st">"assets/ski.csv"</span>)</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ski_sample, <span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>longitude, <span class="at">shape=</span>good_skiing, <span class="at">color=</span>good_skiing)) <span class="sc">+</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> g_pointsize <span class="sc">/</span> <span class="dv">2</span>, <span class="at">stroke=</span><span class="fl">1.5</span>,</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dsan_theme</span>() <span class="sc">+</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Year"</span>,</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Longitude"</span>,</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"Good Skiing?"</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">name=</span><span class="st">"Good Skiing?"</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">"Good Skiing?"</span>, <span class="at">values=</span><span class="fu">c</span>(cbPalette[<span class="dv">1</span>], cbPalette[<span class="dv">2</span>])) <span class="sc">+</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks=</span><span class="fu">c</span>(<span class="fu">ymd</span>(<span class="st">'2023-01-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-02-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-03-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-04-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-05-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-06-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-07-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-08-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-09-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-10-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-11-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-12-01'</span>)),</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Apr"</span>, <span class="st">"May"</span>, <span class="st">"Jun"</span>, <span class="st">"Jul"</span>, <span class="st">"Aug"</span>, <span class="st">"Sep"</span>, <span class="st">"Oct"</span>, <span class="st">"Nov"</span>, <span class="st">"Dec"</span>)</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">90</span>, <span class="sc">-</span><span class="dv">60</span>, <span class="sc">-</span><span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-revealjs/ski-plot-binary-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption"><em>(Example adapted from CS229: Machine Learning, Stanford University)</em></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zero-splits" class="level2 smaller crunch-title crunch-ul crunch-code">
<h2 class="smaller crunch-title crunch-ul crunch-code anchored" data-anchor-id="zero-splits">Zero Splits</h2>
<ul>
<li>Starting out: no splits at all, just guess <strong>most frequent class</strong>: <strong>bad</strong> skiing</li>
</ul>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ski_sample <span class="sc">|&gt;</span> <span class="fu">count</span>(good_skiing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  good_skiing     n
  &lt;lgl&gt;       &lt;int&gt;
1 FALSE          66
2 TRUE           34</code></pre>
</div>
</div>
<ul>
<li>This gives us <span class="math inline">\(\Pr(\text{Correct Guess}) = 0.66\)</span></li>
<li>Let <span class="math inline">\(R_i\)</span> denote the <strong>region</strong> we’re considering at level <span class="math inline">\(i\)</span>, and <span class="math inline">\(\widehat{p}_c(R_i)\)</span> be the proportion of points in region <span class="math inline">\(R_i\)</span> that are of class <span class="math inline">\(c\)</span></li>
<li>Here, since we’re not splitting the region up at all (yet),</li>
</ul>
</section>
<section id="judging-split-options" class="level2 smaller crunch-title crunch-ul crunch-code crunch-math">
<h2 class="smaller crunch-title crunch-ul crunch-code crunch-math anchored" data-anchor-id="judging-split-options">Judging Split Options</h2>
<p>Let’s think through two choices for the first split:</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-center">
<div id="split-choice-left" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<center>
<p><span class="math inline">\(\text{longitude} \geq -30\)</span>:</p>
</center>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ski_sample <span class="ot">&lt;-</span> ski_sample <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">lon_gt_n30 =</span> longitude <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">30</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>ski_sample <span class="sc">|&gt;</span> <span class="fu">group_by</span>(lon_gt_n30) <span class="sc">|&gt;</span> <span class="fu">count</span>(good_skiing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
# Groups:   lon_gt_n30 [2]
  lon_gt_n30 good_skiing     n
  &lt;lgl&gt;      &lt;lgl&gt;       &lt;int&gt;
1 FALSE      FALSE          17
2 FALSE      TRUE           19
3 TRUE       FALSE          49
4 TRUE       TRUE           15</code></pre>
</div>
</div>
<p>This gives us the rule</p>
<p><span class="math display">\[
\widehat{C}(x) = \begin{cases}
0 &amp;\text{if }\text{longitude} \geq -30, \\
0 &amp;\text{otherwise}
\end{cases}
\]</span></p>
</div>
<div id="split-choice-right" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<center>
<p><span class="math inline">\(\text{month} &lt; \text{October}\)</span></p>
</center>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ski_sample <span class="ot">&lt;-</span> ski_sample <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">month_lt_oct =</span> day <span class="sc">&lt;</span> <span class="fu">ymd</span>(<span class="st">'2023-10-01'</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>ski_sample <span class="sc">|&gt;</span> <span class="fu">group_by</span>(month_lt_oct) <span class="sc">|&gt;</span> <span class="fu">count</span>(good_skiing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
# Groups:   month_lt_oct [2]
  month_lt_oct good_skiing     n
  &lt;lgl&gt;        &lt;lgl&gt;       &lt;int&gt;
1 FALSE        FALSE          16
2 FALSE        TRUE            7
3 TRUE         FALSE          50
4 TRUE         TRUE           27</code></pre>
</div>
</div>
<p>This gives us the rule</p>
<p><span class="math display">\[
\widehat{C}(x) = \begin{cases}
0 &amp;\text{if }\text{month} &lt; \text{October}, \\
0 &amp;\text{otherwise}
\end{cases}
\]</span></p>
</div>
</div>
</div>
<p>So, if we judge purely on <strong>acuracy scores</strong>… it seems like we’re <strong>not getting anywhere here</strong> (but, we know we <strong>are</strong> getting somewhere!)</p>
</section>
<section id="scikit-learn" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="scikit-learn">Scikit-Learn</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>sklearn.set_config(display<span class="op">=</span><span class="st">'text'</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>ski_df <span class="op">=</span> pd.read_csv(<span class="st">"assets/ski.csv"</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>ski_df[<span class="st">'good_skiing'</span>] <span class="op">=</span> ski_df[<span class="st">'good_skiing'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> ski_df[[<span class="st">'day_num'</span>, <span class="st">'longitude'</span>]]</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> ski_df[[<span class="st">'good_skiing'</span>]].values</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>dtc <span class="op">=</span> DecisionTreeClassifier(</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  criterion <span class="op">=</span> <span class="st">"entropy"</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>dtc.fit(X, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>DecisionTreeClassifier(criterion='entropy')</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>sklearn.tree.plot_tree(dtc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-revealjs/sklearn-ski-1.png" class="img-fluid figure-img" width="614"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="continuous-values" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="continuous-values">Continuous Values</h2>
<ul>
<li>What if we replace binary labels with <strong>continuous values</strong>: in this case, <strong>cm of snow</strong>?</li>
</ul>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#format_snow &lt;- function(x) sprintf('%.2f', x)</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>format_snow <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">round</span>(x, <span class="dv">2</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>ski_sample[<span class="st">'snowfall_str'</span>] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(ski_sample<span class="sc">$</span>snowfall, format_snow)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#ski_df |&gt; head()</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print(nrow(ski_df))</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ski_sample, <span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>longitude, <span class="at">label=</span>snowfall_str)) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dsan_theme</span>() <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Year"</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Longitude"</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"Good Skiing?"</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks=</span><span class="fu">c</span>(<span class="fu">ymd</span>(<span class="st">'2023-01-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-02-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-03-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-04-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-05-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-06-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-07-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-08-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-09-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-10-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-11-01'</span>), <span class="fu">ymd</span>(<span class="st">'2023-12-01'</span>)),</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Apr"</span>, <span class="st">"May"</span>, <span class="st">"Jun"</span>, <span class="st">"Jul"</span>, <span class="st">"Aug"</span>, <span class="st">"Sep"</span>, <span class="st">"Oct"</span>, <span class="st">"Nov"</span>, <span class="st">"Dec"</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">90</span>, <span class="sc">-</span><span class="dv">60</span>, <span class="sc">-</span><span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-revealjs/ski-plot-continuous-3.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption"><em>(Example adapted from CS229: Machine Learning, Stanford University)</em></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="looking-towards-regression" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="looking-towards-regression">Looking Towards Regression</h2>
<ul>
<li>How could we make a <strong>decision tree</strong> to predict <span class="math inline">\(y\)</span> from <span class="math inline">\(x\)</span> for this data?</li>
</ul>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>expr_pi2 <span class="ot">&lt;-</span> <span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">frac{</span><span class="sc">\\</span><span class="st">pi}{2}$"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>expr_pi <span class="ot">&lt;-</span> <span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">pi$"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>expr_3pi2 <span class="ot">&lt;-</span> <span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">frac{3</span><span class="sc">\\</span><span class="st">pi}{2}$"</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>expr_2pi <span class="ot">&lt;-</span> <span class="fu">TeX</span>(<span class="st">"$2</span><span class="sc">\\</span><span class="st">pi$"</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>x_range <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> pi</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>x_coords <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, x_range, <span class="at">by =</span> x_range <span class="sc">/</span> <span class="dv">100</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>num_x_coords <span class="ot">&lt;-</span> <span class="fu">length</span>(x_coords)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>data_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> x_coords)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>data_df <span class="ot">&lt;-</span> data_df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_raw =</span> <span class="fu">sin</span>(x),</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_noise =</span> <span class="fu">rnorm</span>(num_x_coords, <span class="dv">0</span>, <span class="fl">0.15</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>data_df <span class="ot">&lt;-</span> data_df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y_raw <span class="sc">+</span> y_noise</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co">#y_coords &lt;- y_raw_coords + y_noise</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co">#y_coords &lt;- y_raw_coords</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co">#data_df &lt;- tibble(x = x, y = y)</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>reg_tree_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_df, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> g_pointsize <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dsan_theme</span>(<span class="st">"half"</span>) <span class="sc">+</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Feature"</span>,</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Label"</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> pi,</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> g_linewidth,</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>,pi,(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>pi,<span class="dv">2</span><span class="sc">*</span>pi),</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,expr_pi2,expr_pi,expr_3pi2,expr_2pi)</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>reg_tree_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-revealjs/sine-wave-tree-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="a-zero-level-tree" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="a-zero-level-tree">A Zero-Level Tree</h2>
<ul>
<li>Trivial example: <span class="math inline">\(\widehat{y}(x) = 0\)</span>. How well does this do?</li>
</ul>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># x_lt_pi = data_df |&gt; filter(x &lt; pi)</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mean(x_lt_pi$y)</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>data_df <span class="ot">&lt;-</span> data_df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred_sq_err0 =</span> (y <span class="sc">-</span> <span class="dv">0</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>mse0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(data_df<span class="sc">$</span>pred_sq_err0)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>mse0_str <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, mse0)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>reg_tree_plot <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>cbPalette[<span class="dv">1</span>],</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> g_linewidth</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">xend=</span>x, <span class="at">y=</span><span class="dv">0</span>, <span class="at">yend=</span>y)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>pi, <span class="at">y=</span><span class="fl">0.5</span>, <span class="at">label=</span><span class="fu">paste0</span>(<span class="st">"MSE = "</span>,mse0_str)),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">#box.padding = unit(c(2,2,2,2), "pt")</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-revealjs/constant-guess-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="a-one-level-binary-tree" class="level2 smaller crunch-title crunch-ul crunch-quarto-layout-panel crunch-code crunch-images nostretch">
<h2 class="smaller crunch-title crunch-ul crunch-quarto-layout-panel crunch-code crunch-images nostretch anchored" data-anchor-id="a-one-level-binary-tree">A One-Level Binary Tree</h2>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-center">
<div id="binary-tree-left" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<ul>
<li>Let’s introduce a single branch node:</li>
</ul>
<p><span class="math display">\[
\widehat{y}(x) = \begin{cases}
\phantom{-}\frac{2}{\pi} &amp;\text{if }x &lt; \pi, \\
-\frac{2}{\pi} &amp;\text{otherwise.}
\end{cases}
\]</span></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/binary_tree.svg" class="img-fluid figure-img" width="360"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>get_y_pred <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> pi, <span class="dv">2</span><span class="sc">/</span>pi, <span class="sc">-</span><span class="dv">2</span><span class="sc">/</span>pi)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>data_df <span class="ot">&lt;-</span> data_df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred_sq_err1 =</span> (y <span class="sc">-</span> <span class="fu">get_y_pred</span>(x))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>mse1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(data_df<span class="sc">$</span>pred_sq_err1)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>mse1_str <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, mse1)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>decision_df <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>x, <span class="sc">~</span>xend, <span class="sc">~</span>y, <span class="sc">~</span>yend,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, pi, <span class="dv">2</span><span class="sc">/</span>pi, <span class="dv">2</span><span class="sc">/</span>pi,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  pi, <span class="dv">2</span><span class="sc">*</span>pi, <span class="sc">-</span><span class="dv">2</span><span class="sc">/</span>pi, <span class="sc">-</span><span class="dv">2</span><span class="sc">/</span>pi</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>reg_tree_plot <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>decision_df,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">xend=</span>xend, <span class="at">y=</span>y, <span class="at">yend=</span>yend),</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>cbPalette[<span class="dv">1</span>],</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> g_linewidth</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">xend=</span>x, <span class="at">y=</span><span class="fu">get_y_pred</span>(x), <span class="at">yend=</span>y)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>pi, <span class="at">y=</span><span class="fl">0.5</span>, <span class="at">label=</span><span class="fu">paste0</span>(<span class="st">"MSE = "</span>,mse1_str)),</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">9</span>,</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">#box.padding = unit(c(2,2,2,2), "pt")</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-revealjs/one-level-tree-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="a-one-level-ternary-tree" class="level2 smaller crunch-title crunch-ul crunch-quarto-layout-panel crunch-code crunch-images nostretch">
<h2 class="smaller crunch-title crunch-ul crunch-quarto-layout-panel crunch-code crunch-images nostretch anchored" data-anchor-id="a-one-level-ternary-tree">A One-Level Ternary Tree</h2>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-center">
<div id="binary-tree-left" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<ul>
<li>Now let’s allow three answers:</li>
</ul>
<p><span class="math display">\[
\widehat{y}(x) = \begin{cases}
\phantom{-}\frac{9}{4\pi} &amp;\text{if }x &lt; \frac{2\pi}{3}, \\
\phantom{-}0 &amp;\text{if }\frac{2\pi}{3} \leq x \leq \frac{4\pi}{3} \\
-\frac{9}{4\pi} &amp;\text{otherwise.}
\end{cases}
\]</span></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ternary_tree.svg" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>cut1 <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">*</span> pi</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>cut2 <span class="ot">&lt;-</span> (<span class="dv">4</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">*</span> pi</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>pos_mean <span class="ot">&lt;-</span> <span class="dv">9</span> <span class="sc">/</span> (<span class="dv">4</span><span class="sc">*</span>pi)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>get_y_pred <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> cut1, pos_mean, <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> cut2, <span class="dv">0</span>, <span class="sc">-</span>pos_mean))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>data_df <span class="ot">&lt;-</span> data_df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred_sq_err1b =</span> (y <span class="sc">-</span> <span class="fu">get_y_pred</span>(x))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>mse1b <span class="ot">&lt;-</span> <span class="fu">mean</span>(data_df<span class="sc">$</span>pred_sq_err1b)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>mse1b_str <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, mse1b)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>decision_df <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>x, <span class="sc">~</span>xend, <span class="sc">~</span>y, <span class="sc">~</span>yend,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, (<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>)<span class="sc">*</span>pi, pos_mean, pos_mean,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>)<span class="sc">*</span>pi, (<span class="dv">4</span><span class="sc">/</span><span class="dv">3</span>)<span class="sc">*</span>pi, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">4</span><span class="sc">/</span><span class="dv">3</span>)<span class="sc">*</span>pi, <span class="dv">2</span><span class="sc">*</span>pi, <span class="sc">-</span>pos_mean, <span class="sc">-</span>pos_mean</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>reg_tree_plot <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>decision_df,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">xend=</span>xend, <span class="at">y=</span>y, <span class="at">yend=</span>yend),</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>cbPalette[<span class="dv">1</span>],</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> g_linewidth</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">xend=</span>x, <span class="at">y=</span><span class="fu">get_y_pred</span>(x), <span class="at">yend=</span>y)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>pi, <span class="at">y=</span><span class="fl">0.5</span>, <span class="at">label=</span><span class="fu">paste0</span>(<span class="st">"MSE = "</span>,mse1b_str)),</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">9</span>,</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">#box.padding = unit(c(2,2,2,2), "pt")</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-revealjs/one-level-ternary-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="another-one-level-ternary-tree" class="level2 smaller crunch-title crunch-ul crunch-quarto-layout-panel crunch-code crunch-images nostretch">
<h2 class="smaller crunch-title crunch-ul crunch-quarto-layout-panel crunch-code crunch-images nostretch anchored" data-anchor-id="another-one-level-ternary-tree">Another One-Level Ternary Tree</h2>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-center">
<div id="binary-tree-left" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<ul>
<li>Now let’s allow an <strong>uneven</strong> split:</li>
</ul>
<p><span class="math display">\[
\widehat{y}(x) = \begin{cases}
\phantom{-}0.695 &amp;\text{if }x &lt; (1-c)\pi, \\
\phantom{-}0 &amp;\text{if }(1-c)\pi \leq x \leq (1+c)\pi \\
-0.695 &amp;\text{otherwise,}
\end{cases}
\]</span></p>
<p>with <span class="math inline">\(c \approx 0.113\)</span>, gives us:</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ternary_tree_uneven.svg" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fl">0.113</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>cut1 <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> c) <span class="sc">*</span> pi</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>cut2 <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> c) <span class="sc">*</span> pi</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>pos_mean <span class="ot">&lt;-</span> <span class="fl">0.695</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>get_y_pred <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> cut1, pos_mean, <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> cut2, <span class="dv">0</span>, <span class="sc">-</span>pos_mean))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>data_df <span class="ot">&lt;-</span> data_df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred_sq_err1b =</span> (y <span class="sc">-</span> <span class="fu">get_y_pred</span>(x))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>mse1b <span class="ot">&lt;-</span> <span class="fu">mean</span>(data_df<span class="sc">$</span>pred_sq_err1b)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>mse1b_str <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, mse1b)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>decision_df <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>x, <span class="sc">~</span>xend, <span class="sc">~</span>y, <span class="sc">~</span>yend,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, cut1, pos_mean, pos_mean,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  cut1, cut2, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  cut2, <span class="dv">2</span><span class="sc">*</span>pi, <span class="sc">-</span>pos_mean, <span class="sc">-</span>pos_mean</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>reg_tree_plot <span class="sc">+</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>decision_df,</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">xend=</span>xend, <span class="at">y=</span>y, <span class="at">yend=</span>yend),</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>cbPalette[<span class="dv">1</span>],</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> g_linewidth</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">xend=</span>x, <span class="at">y=</span><span class="fu">get_y_pred</span>(x), <span class="at">yend=</span>y)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>pi, <span class="at">y=</span><span class="fl">0.5</span>, <span class="at">label=</span><span class="fu">paste0</span>(<span class="st">"MSE = "</span>,mse1b_str)),</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">9</span>,</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">#box.padding = unit(c(2,2,2,2), "pt")</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-revealjs/one-level-ternary-uneven-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="on-to-the-code" class="level2">
<h2 class="anchored" data-anchor-id="on-to-the-code">On to the Code!</h2>
<ul>
<li>Scikit-learn has both <a href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html" target="_blank"><code>DecisionTreeClassifier</code> </a><a class="bi bi-box-arrow-up-right"></a> and <a href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeRegressor.html" target="_blank"><code>DecisionTreeRegressor</code> <i class="bi bi-box-arrow-up-right"></i></a> classes!</li>
</ul>
</section>
</section>
<section id="random-forests" class="level1" data-stack-name="Random Forests">
<h1 data-stack-name="Random Forests">Random Forests</h1>
<section id="the-wisdom-of-crowds" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="the-wisdom-of-crowds">The Wisdom of Crowds</h2>
<ul>
<li>Imagine you’re assembling a <strong>darts team</strong>. You can choose a <strong>team of 4</strong> from among the following 8 players:</li>
</ul>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th>Player</th>
<th>Skill</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Larry “Lefty” Lechuga</td>
<td>Always hits 5cm left of bullseye</td>
</tr>
<tr class="even">
<td>Rico Righty</td>
<td>Always hits 5cm right of bullseye</td>
</tr>
<tr class="odd">
<td>Lil Uppy Vert</td>
<td>Always hits 5cm above bullseye</td>
</tr>
<tr class="even">
<td>Inconsistent Inkyung</td>
<td>Hits bullseye 50% of time, other 50% hits random point</td>
</tr>
<tr class="odd">
<td>Diagonal Dave</td>
<td>Always hits 5cm above right of bullseye</td>
</tr>
<tr class="even">
<td>Dobert Downy Jr.</td>
<td>Always hits 5cm below bullseye</td>
</tr>
<tr class="odd">
<td>Gregor “the GOAT” Gregorsson</td>
<td>Hits bullseye 99.9% of time, other 0.1% hits random point</td>
</tr>
<tr class="even">
<td>Craig</td>
<td>Top 25 Craigs of 2023</td>
</tr>
</tbody>
</table>
</section>
<section id="your-opponents" class="level2">
<h2 class="anchored" data-anchor-id="your-opponents">Your Opponents</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/japanese_baseball_game.jpg" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="high-variance-low-bias" class="level2">
<h2 class="anchored" data-anchor-id="high-variance-low-bias">High Variance, Low Bias</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/var-high-bias-low.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="the-wisdom-of-sheep" class="level2">
<h2 class="anchored" data-anchor-id="the-wisdom-of-sheep">The Wisdom of Sheep</h2>
<ul>
<li>Unfortunately, the “wisdom of crowds” phenomenon only works if everyone in the crowd is <strong>unable to communicate</strong></li>
<li>The minute people tasked with making decisions as a group begin to communicate (long story short), they begin to follow charismatic leaders <img src="images/thinking_transparent.png" class="img-fluid" style="display: inline-flex;" width="60">, and the effect goes away (biases no longer cancel out)</li>
<li>The takeaway for effectively training <strong>random forests</strong>: ensure that each tree has a <strong>separate (ideally orthogonal) slice</strong> of the full dataset, and has to infer labels from only that slice!</li>
</ul>
</section>
<section id="appendix-covariance-matrix-magic" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="appendix-covariance-matrix-magic">Appendix: Covariance Matrix Magic</h2>
<ul>
<li>For those interested (skipping over lots of matrix math): say you have a 2D covariance matrix <span class="math inline">\(\mathbf{\Sigma}\)</span> with eigensystem <span class="math inline">\((\lambda_1, \mathbf{x}_1), (\lambda_2, \mathbf{x}_2)\)</span></li>
<li>You can obtain a <strong>new</strong> covariance matrix <span class="math inline">\(\mathbf{\Sigma}'\)</span> which has the <strong>same eigenvalues</strong> as <span class="math inline">\(\mathbf{\Sigma}\)</span> but has eigen<strong>vectors</strong> <span class="math inline">\(\mathbf{x}'_1\)</span> and <span class="math inline">\(\mathbf{x}'_2\)</span>, so long as these two eigenvectors are <strong>orthogonal</strong>.</li>
<li>Example: you want to retain the eigenvalues <span class="math inline">\(\lambda_1 = 3\)</span> and <span class="math inline">\(\lambda_2 = 1\)</span> from the <a href="#pca-math-magic">quiz-review slides</a>, but want the data’s <strong>first</strong> principal component to be <span class="math inline">\(\mathbf{x}'_1 = (2,1)^\top\)</span> and its <strong>second</strong> principal component to be <span class="math inline">\(\mathbf{x}'_2 = (-1,2)^\top\)</span>.</li>
<li>By constructing the Eigenmatrix <span class="math inline">\(\mathbf{V} = \left[\begin{smallmatrix} \mathbf{x}'_1 &amp; \mathbf{x}'_2\end{smallmatrix}\right]\)</span> (the matrix whose columns are <span class="math inline">\(\mathbf{x}'_1\)</span> and <span class="math inline">\(\mathbf{x}'_2\)</span>), we can obtain <span class="math inline">\(\mathbf{\Sigma}'\)</span> by computing:</li>
</ul>
<p><span class="math display">\[
\mathbf{\Sigma}' = \mathbf{V}\mathbf{\Sigma}\mathbf{V}^{-1}.
\]</span></p>
<ul>
<li>(Exercise: recreate the plot from the earlier PCA slides, but with these desired first and second principal components! <a href="https://www.visiondummy.com/2014/04/geometric-interpretation-covariance-matrix/" target="_blank">See here</a> for a deeper dive into why this works!)</li>
</ul>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-vandermaaten_visualizing_2008" class="csl-entry" role="listitem">
Van der Maaten, Laurens, and Geoffrey Hinton. 2008. <span>“Visualizing Data Using t-<span>SNE</span>.”</span> <em>Journal of Machine Learning Research</em> 9 (11).
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>